<html>

<head>
<style type="text/css">
<!--
.ourfont{font-size: 12px;line-height: 17px;}
A:link {text-decoration: none; color: blue}
A:visited {text-decoration: none; color: "#54646D"}
A:active {text-decoration: none}
A:hover {text-decoration: underline; color: 000080} 
-->
</style>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>《电脑报》</title>
</head>

<body bgcolor="#FFFFFF">

<hr align="center" width="700">
<div align="center"><center>

<table border="0" width="700" cellspacing="0" cellpadding="4" bgcolor="#ECF7F4">
  <tr>
    <td width="100%" valign="top"><div align="center"><center><table border="0" width="680"
    cellspacing="0" cellpadding="4">
      <tr>
        <td width="672" valign="top"><p align="center"><font face="黑体" color="#004080"><strong>将应用程序放到系统盒中 
        <br>
        </strong></font></td>
      </tr>
      <tr>
        <td width="672" valign="top"><p class="ourfont" align="left"><font color="#369681"> 
        &nbsp;&nbsp; 　在Win95的任务栏上，我们发现一些Win95应用程序可以以小图标的方式放到系统盒中，如ICQ、Realplayer、金山词霸等。系统盒（System 
        Tray）是任务栏右边的一个凹进去的小框。其实要实现这个功能，可以用VB5.0编一应用程序管理器，以自己喜欢的方式设置菜单，并且该程序在系统启动后能自动放到系统盒中，同时还伴随着一段优美的音乐。实现步骤如下：<br>
        　　一、创建SysTray控件<br>
        　　1．打开VB光盘上\Tools\UNSUPPRT\Systray目录下的Systray.vbp工程文件。<br>
        　　2．选择菜单项“文件/生成Systray.ocx”，并在“保存在”对话框中设置目录为C:\WINDOWS\SYSTEM，然后“确定”编译该控件。<br>
        　　现在SysTray控件已准备好，你的应用程序可以使用它了。<br>
        　　二、使用SysTray控件<br>
        　　1．选择菜单项“文件/新建工程”，并将窗体Form1的“名称”属性改变为frmMain。<br>
        　　2．用鼠标右键单击工具箱，选择“部件…”，在对话框“浏览”中选择文件C:\WINDOWS\SYSTEM\Systray.ocx，把SysTray控件加到你的工具箱中。<br>
        　　3．把SysTray控件加到窗体frmMain中，并设其“名称”属性为“cls 
        SysTray”，设其“InTray”属性为“True”，“TrayTip”属性为“应用程序管理器”。<br>
        　　4．单击frmMain窗体使其激活，选择菜单项“工具/菜单编辑器”，创建一个菜单，将“标题”属性设为“＆程序”，将“名称”属性设为“mnuApp”，单击“下一个”按钮。<br>
        　　5．单击右箭头创建以下二级菜单：<br>
        　　标题　　　名称<br>
        　　＆记事本　mnuAppNotepad<br>
        　　－　　　　mnuAppSep1<br>
        　　＆关闭　　mnuAppClose<br>
        　　6．双击frmMain，打开它的代码窗口，给Load事件添加如下代码：<br>
        　　Private Sub Form_Load()<br>
        　　MeHide<br>
        　　MMControl1.Notify=False<br>
        　　MMControl1.Wait=True<br>
        　　MMControl1.Shareable=False<br>
        　　MMControl1.DeviceType=″waveaudio″<br>
        　　MMControl1.filename=″e:\fodder\sound\gohome.wav″<br>
        　　MMControl1.Command=″Open″<br>
        　　MMControl1.Command=″Play″<br>
        　　End Sub<br>
        　　7．打开clsSysTray的MouseDown事件，添加如下代码：<br>
        　　Private Sub clsSysTray_MouseDown(Button As Integer,Id As Long)<br>
        　　If Button=2 Then<br>
        　　PopupMenu mnuApp<br>
        　　End If<br>
        　　End Sub<br>
        　　8．给mnuAppNotepad的Click事件添加如下代码：<br>
        　　Private Sub mnuAppNotepad_Click()<br>
        　　Dim rc As Double<br>
        　　rc=Shell(″C:\Windows\Notepadexe″,vbNormalFocus)<br>
        　　End Sub<br>
        　　9．给mnuAppClose的Click事件添加如下代码：<br>
        　　Private Sub mnuAppClose_Click()<br>
        　　Unload Me<br>
        　　Set frmMain=Nothing<br>
        　　End Sub<br>
        　　10．最后，保存工程并编译成EXE文件，并将该程序放到“启动”菜单中。<br>
        　　重新启动计算机，你会发现系统盒中多了一个小图标，并伴随着音乐。如果把鼠标放在它上面停留两秒钟，会看到提示“应用程序管理器”，右击该图标，就会出现一个弹出式菜单。至此，大功告成！(浙江　吴　丰)<br>
        <br>
        </font></p>
        <p align="right"><span class="ourfont"><font color="#369681">本文出自：</font><a
        href="index.htm">《电脑报》1998年9月28日第37期13版</a></span></td>
      </tr>
    </table>
    </center></div></td>
  </tr>
</table>
</center></div>
</body>
</html>
