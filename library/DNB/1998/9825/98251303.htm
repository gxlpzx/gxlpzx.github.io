<html>

<head>
<style type="text/css">
<!--
.ourfont{font-size: 12px;line-height: 17px;}
A:link {text-decoration: none; color: blue}
A:visited {text-decoration: none; color: "#54646D"}
A:active {text-decoration: none}
A:hover {text-decoration: underline; color: 000080} 
-->
</style>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>《电脑报》</title>
</head>

<body bgcolor="#FFFFFF">

<hr align="center" width="700">
<div align="center"><center>

<table border="0" width="700" cellspacing="0" cellpadding="4" bgcolor="#ECF7F4">
  <tr>
    <td width="100%" valign="top"><div align="center"><center><table border="0" width="680"
    cellspacing="0" cellpadding="4">
      <tr>
        <td width="672" valign="top"><p align="center"><font face="黑体" color="#004080"><strong>Delphi中RichEdit的奥妙</strong></font></td>
      </tr>
      <tr>
        <td width="672" valign="top"><p class="ourfont" align="left"><font color="#369681">&nbsp; 
        &nbsp;&nbsp; <strong> 一、如何得知当前行号</strong><br>
        　　用RichEdit（或者memo）控件制作文本编辑器时，通过访问linescount属性可以得到总行数，但是若想知道光标当前所在行的行号就麻烦了，因为delphi没有提供这个属性。要实现这个编辑器必备功能，就须调用em_ 
        LineFromChar。请试试下面的程序。<br>
        　　先在窗口中布置一个RichEdit或者memo（命名为editor），以及一个button。在button的onclick事件中写入下列代码。<br>
        　　var<br>
        　　CurrentLine:Integer;<br>
        　　begin<br>
        　　CurrentLine:=EditorPerform(em_ LineFromChar,SFFFF,0);<br>
        　　ApplicationMessageBox(PChar(′当前行号是′＋IntToStr(CurrentLine)),′消息′,mb_ 
        iconinformation);<br>
        　　end;<br>
        　　需要注意的是，第一行的行号为零。<br>
        　　<strong>二、如何撤消操作（undo）</strong><br>
        　　对于memo来说，实现undo是不需编程的，只要让popupmenu属性为空，运行时就能用鼠标右键激活一个常用操作菜单，其中包括撤消、剪切、复制、粘贴、删除和全选六项。<br>
        　　但可惜的是，这一招对于功能强大的RichEdit控件居然行不通，害得我们还要自己设计一个popupmemu。当你用CutToClipBoard等语句轻松而顺利地完成了“剪切”等功能，接着便会无奈地发现，竟找不到undo或cancel之类的语句来执行“撤消”。<br>
        　　这时你需要这样处理：<br>
        　　RichEdit1Perform(EM_UNDO,0,0);<br>
        　　另外还应检查是否允许撤消，从而开启或关闭弹出菜单中的“撤消”项：<br>
        　　Undo1Enabled:=RichEditPerform(EM_CANUNDO,0,0)&lt;&gt;0;<br>
        　　以上程序在Delphi3中调试通过。　　<strong>(上海　汪　箴)</strong></font></p>
        <p align="right"><span class="ourfont"><font color="#369681">本文出自：</font><a
        href="index.htm">《电脑报》1998年6月29日第25期13版</a></span></td>
      </tr>
    </table>
    </center></div></td>
  </tr>
</table>
</center></div>
</body>
</html>
