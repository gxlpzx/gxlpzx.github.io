<HTML><!-- #BeginTemplate "/Templates/software.dwt" -->
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=utf-8'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='epcw.css' TYPE='text/css'>
<!-- #BeginEditable "doctitle" --> 
<TITLE>电脑报电子版 -- 用DELPHI编写CCI程序</TITLE>
<!-- #EndEditable --> 
<style type="text/css">
<!--
.centertitle {  font-weight: bold; text-align: center; line-height: 35px; font-size: 9pt; color: #000000}
.lefttitle {  line-height: 35px; font-weight: bold; font-size: 9pt; color: #000000}
-->
</style>
</HEAD>
<BODY BGCOLOR='white'>
<span class="centertitle"></span> 
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>
<TD WIDTH='145' BGCOLOR='#CCCC99' 	ALIGN='Center' VALIGN='top'><A HREF='http://www.yesky.com'><IMG SRC='images/logo.gif' WIDTH='140' HEIGHT='60' ALT='天极网' BORDER='0'></A></TD>
<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><a href="http://chat.yesky.com"><img src="images/0823-3.gif" width="468" height="60" border="0"></a></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE BORDER='0' WIDTH='615' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE>
<table width='615' border='0' cellspacing='0' cellpadding='2' align='Center'>
  <tr> 
    <td width='615' colspan='2'><font color="#FF6666">当前位置：</font><A HREF='http://www.cpcw.com/issue/index.html'>CPCW电子版</A> 
      &gt; <A HREF='http://www.cpcw.com/issue/all.html'>2000年</A> &gt; <a href="index.html"><!-- #BeginEditable "%C6%DA" -->24期<!-- #EndEditable --></a> 
      &gt; <!-- #BeginEditable "%C0%B8%C4%BF" --><a href="software.html">软件世界</a><!-- #EndEditable --> 
      &gt; <!-- #BeginEditable "%B1%EA%CC%E2" -->用DELPHI编写CCI程序<!-- #EndEditable --></td>
  </tr>
</table>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='615' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR>
    <TD><SPAN CLASS='title'>《 <!-- #BeginEditable "%CE%C4%D5%C2%CD%B7" -->用DELPHI编写CCI程序<!-- #EndEditable --> 
      》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->
      <p>　　随着Internet时代的来临，为WWW(World Wide Web)编写程序已经变得越来越普遍起来。大量的数据库应用和其他一些较为复杂的操作使得HTML越来越无法满足我们的需要，就算是JavaScript也只能完成一些较为简单的程序，所以众多主页都使用了CGI。许多刚开始制作个人主页的“菜鸟”也渴望了解CGI的编程技术，下面我介绍一下CGI的编程方法。<br>
        　　首先，你必须会一种编译型的编程语言，如：Dlephi。然后，你需要一个Web服务器，如果没有的话，可以免费去微软的网站下载一个Personal 
        Web Server。<br>
        　　下面就让我们开始吧！<br>
        　　先建立一个没有窗体的控制台应用程序（注：向代码中添加{SAPPTYPE CONSOLE}使程序转为控制台应用程序），然后输入相应的代码如下：<br>
        　　PROGRAM XHCGI;<br>
        　　{SAPPTYPE CONSOLE}<br>
        　　USES<br>
        　　WINDOWS,SYSUTILS;<br>
        　　CONST<br>
        　　CGIVAR:ARRAY[1..22]OF STRING[30]=<br>
        　　(′SERVER_NAME′,<br>
        　　′SERVER_PROTOCOL′,<br>
        　　′SERVER_PORT′,<br>
        　　′SERVER_SOFTWARE′,<br>
        　　′PATH_TRANSLATED′,<br>
        　　′PATH_INFO′,<br>
        　　′REMOTE_HOST′,<br>
        　　′REMOTE_USER′,<br>
        　　′REMOTE_ADDR′,<br>
        　　′REMOTE_IDENT′,<br>
        　　′REQUEST_METHOD′,<br>
        　　′GATEWAY_INTERFACE′,<br>
        　　′DOCUMENT_ROOT′,<br>
        　　′SCRIPT_NAME′,<br>
        　　′QUERY_STRING′,<br>
        　　′HTTP_REFERER′,<br>
        　　′HTTP_ACCEPT′,<br>
        　　′HTTP_USER_AGENT′,<br>
        　　′HTTP_FROM′,<br>
        　　′CONTENT_TYPE′,<br>
        　　′CONTENT_LENGTH′,<br>
        　　′CONTENT_COOKIE′);<br>
        　　//一些常用的CGI环境变量。<br>
        　　VAR<br>
        　　TESTSTR:ARRAY[0..255]OF CHAR;<br>
        　　BEGIN<br>
        　　WRITELN(′CONTENT TYPE:TEXT/HTML′);<br>
        　　WRITELN;<br>
        　　WRITELN(′&lt;HTML&gt;′);<br>
        　　WRITELN(′&lt;HEAD&gt;′);<br>
        　　WRITELN(′&lt;META HTTP－EQUIV=″CONTENT－TYPE″ CONTENT=″TEXT/HTML; CHARSET=GB2312″&gt;′);<br>
        　　WRITELN(′&lt;TITLE&gt;星河创作室 ＆GT;＆GT; CGI测试&lt;/TITLE&gt;′);<br>
        　　WRITELN(′&lt;/HEAD&gt;′);<br>
        　　WRITELN(′&lt;BODY BGCOLOR=″＃000000″ TEXT=″＃FFFFFF″ LINK=″＃00FF00″ VLINK=″＃00FFFF″ 
        <br>
        　　ALINK=″＃FFFF00″&gt;′);<br>
        　　GETENVIRONMENTVARIABLE(′REQUEST_METHOD′,TESTSTR,SIZEOF(TESTSTR));<br>
        　　WRITELN(′星河创作室′);<br>
        　　WRITELN(′&lt;BR&gt;′);<br>
        　　FOR CGIVARS:=LOW(CGIVAR) TO HIGH(CGIVAR) DO<br>
        　　BEGIN<br>
        　　CGISTR:=CGIVAR[CGIVARS];<br>
        　　GETENVIRONMENTVARIABLE(PCHAR(CGISTR),TESTSTR,SIZEOF(TESTSTR));<br>
        　　WRITELN(CGISTR＋′: ′＋TESTSTR);<br>
        　　WRITELN(′&lt;BR&gt;′);<br>
        　　END;<br>
        　　//FOR 为依次以CGIVAR数组中的CGI环境变量名来读取CGI环境变量，然后发给浏览器。<br>
        　　WRITELN(′&lt;/BODY&gt;′);<br>
        　　WRITELN(′&lt;/HTML&gt;′);<br>
        　　END.<br>
        　　在浏览器的地址栏中输入程序的地址，运行一下，你可以看到一些CGI环境变量。如Web服务器的主机名、HTTP请求的协议、Web 服务器的名称与版本等等。<br>
        　　其实，以上的程序只是读取一些CGI环境变量，并没有实际的意义。使用CGI最主要的目的是要读取浏览器中HTML窗体送出的数据信息。<br>
        　　代码如下：<br>
        　　PROCEDURE GETPOST;<br>
        　　VAR<br>
        　　STRVAR,STRTEST:STRING;<br>
        　　STRLEN:ARRAY[0..10]OF CHAR;<br>
        　　BEGIN<br>
        　　GETENVIRONMENTVARIABLE(′QUERY_STRING′,STRLEN,SIZEOF(STRLEN));<br>
        　　//读取浏览器HTML窗体送出的信息<br>
        　　SETLENGTH(STRVAR,STRTOINTDEF(STRLEN,100));<br>
        　　READLN(STRVAR);<br>
        　　STRTEST:=EXTRACTFROMDATA(STRVAR,′NAME′);<br>
        　　//读取名为NAME的输入框中的输入信息<br>
        　　STRTEST:=NAMECRC(STRTEST);<br>
        　　WRITELN(′姓名：′＋STRTEST);<br>
        　　WRITELN(′&lt;BR&gt;′);<br>
        　　END;<br>
        　　下面是输入信息分解模块（上面的模块中要使用）：<br>
        　　FUNCTION EXTRACTFROMDATA(DATA,TAG:STRING):STRING;<br>
        　　VAR NPOS:INTEGER;<br>
        　　BEGIN<br>
        　　NPOS:=POS(TAG＋′=′,DATA);<br>
        　　IF NPOS&gt;0 THEN<br>
        　　BEGIN<br>
        　　RESULT:=COPY(DATA,NPOS＋1＋LENGTH(TAG),LENGTH(DATA)－NPOS);<br>
        　　NPOS:=POS(′＆′,RESULT);<br>
        　　IF NPOS&gt;0 THEN RESULT:=COPY(RESULT,1,NPOS－1);<br>
        　　END ELSE RESULT:=′′;<br>
        　　END;<br>
        　　好了，一个简单的CGI程序已经完成了，你可以做一个网页试一下CGI的效果。下面就要靠你自己努力了，祝你早日成为CGI高手（如果你在CGI编程中遇到问题，可以写信给我(E－mail:xinghesoft@8848.net)，进行交流)。</p>
      <p align="right"><br>
        　　（上海　汪继梁）</p>
      <!-- #EndEditable --></TD>
  </TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
    <TD>&nbsp;</TD>
    <TD ALIGN='right'><A HREF='00241808.htm#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='615' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='615' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
    <TD>&nbsp;</TD>
    <TD> <a name='top'></a> <img src='http://cq.cpcw.com/cgi-bin/Count.cgi?ft=2|md=8|df=cpcw.dat|dd=E|cache=F|expires=18000' width='1' height='1' alt='312345678'> 
      <script language='JavaScript'>
document.write('<a href=http://best.nease.net/cgi-bin/view/viewbasic.cgi?cpcw target=_blank><img src=\'http://best.nease.net/cgi-bin/log.cgi?user=cpcw&refer='+escape(document.referrer)+'&cur='+escape(document.URL)+'\' border=0 alt=\'网易中文排行榜\' width=15 height=15></a>');
</script>
      <noscript> <a href='http://best.nease.net/cgi-bin/view/viewbasic.cgi?cpcw' target='_blank'> 
      <img src='http://best.nease.net/cgi-bin/log.cgi?user=cpcw&refer=http%3A//www.cpcw.com/&cur=http%3A//www.cpcw.com/issue/1999/50/99500302.html#NoJavaScript' width='1' height='1' border='0' alt='网易中文排行榜'></a> 
      <!-- Start of NedStat Basic code --> <a href="http://usa.nedstatbasic.net/cgi-bin/viewstat?name=cpcwissue"><img
src="http://usa.nedstatbasic.net/cgi-bin/nedstat.gif?name=cpcwissue"
border=0 alt="" nosave width=1 height=1></a> <!-- End of NedStat Basic code --> 
      <!-- Start of ReferStat --> 
      <script type="text/javascript" language="JavaScript">
<!--
d=document;
d.write("<img src=\"http://usa.nedstatbasic.net");
d.write("/cgi-bin/referstat.gif?");
d.write("name=cpcwissue&refer=");
d.write(escape(top.document.referrer));
d.write("\" width=1 height=1 align=\"right\">");
// -->
</script>
      <!-- End of ReferStat --></noscript> <A HREF='../../../../www_lpzx_edu_default.html'>CPCW版权所有</A>，<A HREF='mailto:webmaster@staff.yesky.com'>YESKY天极网编辑部</A>设计制作发布<script language="JavaScript" src="http://www.lpzx.edu.cn/library/DNB/download/yeskye.js">
</script></TD>
</TR>
</TABLE></BODY><!-- #EndTemplate --></HTML>