 
<html>
<head>
<title>《电脑报》电子版CPCW.COM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="library/DNB/2001/0138/cpcw.css">
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="2" marginwidth="0" marginheight="0">
<table width="770" border="1" cellspacing="0" cellpadding="1" align="center" bordercolorlight="#CCCCCC" bordercolordark="#FFFFFF">
  <tr> 
    <td width="148" align="center"> <iframe src="http://www.lpzx.edu.cn/library/www.yesky.com/adj/html/cpcw-left.htm" width="140" height="60" frameborder="0" scrolling="no"></iframe> 
    </td>
    <td width="473" align="center" height="61"> 
      <script language="JavaScript" src="http://www.lpzx.edu.cn/library/www.yesky.com/adj/js/cpcw.js"></script>
    </td>
    <td align="center" width="149"><iframe src="http://www.lpzx.edu.cn/library/www.yesky.com/adj/html/cpcw-right.htm" width="140" height="60" frameborder="0" scrolling="no"></iframe></td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center" height="22" bgcolor="#3366CC">
  <tr> 
    <td width="40" align="center" height="20"><img src="images/b1.gif" width="14" height="14"></td>
    <td width="583" height="20"> <span class="wj">| <a href="wrapup.html" class="wj"><font color="#FFFFFF">综合报道</font></a> 
      | <a href="software.html"><font color="#FFFFFF">软件世界</font></a> 
      | <a href="hardware.html"><font color="#FFFFFF">硬件周刊</font></a> 
      | <a href="internet.html"><font color="#FFFFFF">互联网时代</font></a> 
      | <a href="oa.html"><font color="#FFFFFF">OA专刊</font> </a>| 
      <a href="game.html"><font color="#FFFFFF">游戏广场</font></a> 
      | <a href="library/DNB/2001/0138/maket.html"><font color="#FFFFFF">评测与市场</font></a> 
      | <a href="zt.html"><font color="#FFFFFF">专题版</font> </a>| 
      <a href="library/DNB/default.htm"><font color="#FFFFFF">首页</font></a></span></td>
    <td align="right" width="147" rowspan="2">&nbsp;</td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center" height="48">
  <tr> 
    <td width="174" valign="bottom"><a href="library/DNB/default.htm"><img src="tit.gif" width="169" height="68" border="0"></a></td>
    <td width="448" class="nava"><span class="nava">严正声明<br>
      　　未经许可，任何商业网站或个人网站都不得提供《电脑报》电子版的浏览或下载！违者我们将追究其法律责任！</span></td>
    <td align="right" width="148" valign="top"><a href="library/www.yesky.com/default.htm"><img src="http://www.lpzx.edu.cn/library/www.yesky.com/newimages/news/logo.gif" width="140" height="60" border="0"></a></td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center" height="11">
  <tr> 
    <td width="169" rowspan="2" valign="top">&nbsp;</td>
    <td width="141" rowspan="2" valign="top">&nbsp;</td>
  </tr>
  <tr> 
    <td width="460" height="9"></td>
  </tr>
</table>
<table width="772" border="0" cellspacing="0" cellpadding="0" align="center">
  <tr> 
    <td colspan="3" valign="top"> 
      <table width="600" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <td class="nava"><font color="#FF9900">你所在的位置：&gt;&gt;<a href="library/DNB/default.htm">《电脑报》电子版</a> 
            &gt;&gt;<a href="index.html">2001年第38期 </a>&gt;&gt;<a href="software.html">软件世界</a></font></td>
        </tr>
      </table>
      <table width="600" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <td> 
            <div align="center">VB程序编程风格谈</div>
          </td>
        </tr>
      </table>
      <table width="600" border="1" cellspacing="0" cellpadding="5" align="center" bordercolor="#FFCC99">
        <tr> 
          <td> 
            <p>编程的过程中最容易忽略的是程序的“风格”。一个好的程序，不但要有简明精确的算法、严密的逻辑思维和正确的思想体现，程序的风格也同样重要。好的程序风格，可以让我们的程序写得更加平易近人，更加生动，对我们的编程是大有益处的，对我们的程序学习也能起到事半功倍的作用。或者说，编程过程中我们应该遵守一些不成文的标准，这对于我们与他人的交流和自己的再学习都是有益无害的。<br>
              编程的过程中，我们应遵守一些成文的或不成文的标准。虽然这些标准对于程序在计算机上的运行意义不大，但对于我们的学习交流却意义深远。也就是说，这些准则没有对程序的逻辑结构做出硬性规定，但对程序的外观却提出了规范化的要求。<br>
              使用统一编码约定集的主要原因，是使应用程序的结构和编码风格标准化，以便于阅读和理解。好的编码可使源代码的可读性强且意义清楚，与其他语言约定相一致，并且尽可能直观。我们自己一眼能看出个大概，在别人眼中也不至于成为千古奇书。<br>
              VB编程过程中，主要有如下约定。<br>
              ##1 一、对象命名约定<br>
              应该使用一致的前缀来命名对象，使人们容易识别对象的类型。例如我们常用控件CommandButton(命令按钮)可用cmd做为其前缀。与之似，Form以frm，Image以img，Label以lbl，List 
              Box以lst，Picture Box以pic，Timer以tmr做为前缀是很方便区分的。在我们编程的过程中，我们看到下面的名称cmdExit我们就知道这一定是一个命令按钮了。如果是第三方提供的控件，我们的说明最好要清晰地标出制造商的名称，以区别于我们的常用控件。<br>
              ##1 二、常量和变量命名约定<br>
              除了控件以外，常量和变量也是我们编程过程中经常遇到的，我们也是通过名字和它们打交道的。<br>
              1.给变量加范围前缀<br>
              变量按其作用范围可分做三类，过程级，模块级和全局，所以我们在编程的过程中应将三者加以区别。<br>
              我们在使用变量时，为了更好地体现代码重用和可维护原则，其定义范围应尽量缩小，这样将使我们的应用程序更加容易理解和易于控制。<br>
              在VB应用程序中，只有当没有其他方便途径在窗体间共享数据时才使用全局变量。当使用全局变量时，在一个单一模块中声明它们，并按功能分组，给模块取一个有意义的名字。较好的编码习惯是尽可能地用模块化的代码。除了全局变量，过程和函数应该仅对传递给它们的的对象操作。在过程中使用的全局变量应该在过程起始处的声明部分标识出来。<br>
              变量的作用范围前缀如下：全局g(global)，模块级m(model)，本地过程不需要使用。例如：gintFlag表示全局整型变量，mstrPassword可表示模块级字符型变量。<br>
              2.声明所有变量原则<br>
              声明所有变量将会节省编程时间，键入错误将大大减少，我们可在程序开始写上如下语句：<br>
              Option Explicit<br>
              该语句要求在程序中声明所有变量。<br>
              3.变量数据类型声明<br>
              可通过下面的前缀来作为变量的数据类标志。<br>
              Boolean bln<br>
              Byte byt<br>
              Double dbl<br>
              Integer int<br>
              String str<br>
              4.常量<br>
              常量的命名，可遵循与常量命名大体相同的原则。<br>
              5.对变量和过程名作出描述<br>
              变量或过程名的主体应该使用大小写混合的形式，并且应该有足够长度以描述它的作用。而且，函数名应以一个动词开头，如JudgeDialog。<br>
              ##1 三、结构化编码约定<br>
              除了上述的约定外，结构化的程序风格对于我们实际编程也很有意义，可极大地改善代码的可读性。结构化编码约定主要有代码注释和一致性缩进。<br>
              1.代码注释约定<br>
              所有的过程和函数都应该以描述这段过程的功能的一段简明的注释开始，说明该程序是干什么的，至于是如何做的，也就是编程的细节，最好不要包括。因为日后我们可能要修改程序，这样做会带来不必要的注释维护工作，如果不修改，就将提供误导信息，可能成为错误的注释，因为代码本身和后面程序中的注释将起到相应的说明作用。<br>
              过程中的注释块应该包括如下标题：<br>
              小节 描述内容<br>
              目的 该过程完成什么<br>
              假设 列出每个外部变量、控件、打开文件或其他不明显元素<br>
              效果 列出每个被影响的外部变量、控件或文件及其作用(只有当它不明显时)<br>
              输入 每一个可能不明显的参数<br>
              返回 函数返回值的说明<br>
              2.格式化代码<br>
              下面是VB中的计算器示例的一部分，从中我们不难看出格式化代码的约定。<br>
              (1)标准的，基于制表位的嵌套应该包括一个嵌注释，用来描述该变量的使用。<br>
              (2)变量、控件及过程的命名应该足够清楚，使得只有复杂的执行细节才需要嵌入注释。<br>
              (3).bas 模块包含工程的VB一般常量声明，在其起始处，应包括程序的综述，列举主要数据对象，过程、算法、对话、数据库及系统需求。<br>
              Option Explicit<br>
              Dim Op1Op2 '预先输入操作数。<br>
              Dim DecimalFlag As Integer '小数点存在吗？<br>
              Dim NumOps As Integer '操作数个数。<br>
              Dim LastInput '指示上一次按键事件的类型。<br>
              Dim OpFlag '指示未完成的操作。<br>
              Dim TempReadout<br>
              '小数点(.)按钮的 Click 事件过程<br>
              '如果上一次按键为运算符，初始化 readout 为 “0.”；<br>
              '否则显示时追加一个小数点。<br>
              Private Sub Decimal_Click<br>
              If LastInput = “NEG” Then<br>
              Readout = Format0 “-0.”<br>
              ElseIf LastInput &lt;＞ “NUMS” Then<br>
              Readout = Format0 “0.”<br>
              End If<br>
              DecimalFlag = True<br>
              LastInput = “NUMS”<br>
              End Sub<br>
              写程序和做人一样，外表也是非常重要的，是我们交流中不可缺少的东西。以上经验对其它编程语言同样适用，希望能对初学者的你有所帮助。</p>
            </td>
        </tr>
      </table>
      <br>
      <br>
      <br>
    </td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center" height="4" bgcolor="#FF9900">
  <tr> 
    <td width="161" bgcolor="#99CCFF"> </td>
    <td width="610" bgcolor="#FF9900"></td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center">
  <tr> 
    <td> 
      <div align="center"><a href="library/DNB/bill/index.html" target="_blank"></a><a href="library/DNB/hdong/gao.htm" target="_blank"> 
        欢迎投稿 </a> | <a href="library/DNB/bill/index.html" target="_blank">广告联系</a>| <a href="library/DNB/serve/dnbjs.htm" target="_blank">关于我们</a>| 
        <a href="library/DNB/maillist/index.html" target="_blank">电子杂志</a>| <a href="library/DNB/hdong/zaopin.html" target="_blank">加入我们</a>| 
        <a href="library/DNB/hdong/xinsi.html" target="_blank">隐私条款</a></div>
    </td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center">
  <tr> 
    <td> 
      <div align="center"><span class="nava"><font color="#000000" face="Arial, Helvetica, sans-serif"> 
        Copyright (C) 2000 Yesky.com, All Rights Reserved </font><font color="#000000"><br>
        版权所有　 <font face="Arial, Helvetica, sans-serif"> Yesky </font><br>
        <a href="mailto:webmaster@yesky.com"> 如有意见请与我们联系 </a></font></span></div>
    </td>
  </tr>
</table>
</body>
</html>
