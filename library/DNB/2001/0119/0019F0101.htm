 
<html>
<!-- #BeginTemplate "/Templates/zt.dwt" --> 
<head>
<!-- #BeginEditable "doctitle" --> 
<title>注册表及其备份与恢复</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="library/DNB/Templates/cpcw.css">
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="2" marginwidth="0" marginheight="0">
<table width="770" border="1" cellspacing="0" cellpadding="1" align="center" bordercolorlight="#CCCCCC" bordercolordark="#FFFFFF">
  <tr> 
    <td width="148" align="center"> <iframe src="http://www.lpzx.edu.cn/library/www.yesky.com/adj/html/cpcw-left.htm" width="140" height="60" frameborder="0" scrolling="no"></iframe> 
    </td>
    <td width="473" align="center" height="61"> 
      <script language="JavaScript" src="http://www.lpzx.edu.cn/library/www.yesky.com/adj/js/cpcw.js"></script>
    </td>
    <td align="center" width="149"><iframe src="http://www.lpzx.edu.cn/library/www.yesky.com/adj/html/cpcw-right.htm" width="140" height="60" frameborder="0" scrolling="no"></iframe></td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center" height="22" bgcolor="#3366CC">
  <tr> 
    <td width="40" align="center" height="20"><img src="http://www.lpzx.edu.cn/library/DNB/Templates/images/b1.gif" width="14" height="14"></td>
    <td width="583" height="20"> <span class="wj">| <a href="library/DNB/Templates/wrapup.html" class="wj"><font color="#FFFFFF">综合报道</font></a> 
      | <a href="library/DNB/Templates/software.html"><font color="#FFFFFF">软件世界</font></a> 
      | <a href="library/DNB/Templates/hardware.html"><font color="#FFFFFF">硬件周刊</font></a> 
      | <a href="library/DNB/Templates/internet.html"><font color="#FFFFFF">互联网时代</font></a> 
      | <a href="library/DNB/Templates/oa.html"><font color="#FFFFFF">OA专刊</font> 
      </a>| <a href="library/DNB/Templates/game.html"><font color="#FFFFFF">游戏广场</font></a> 
      | <a href="library/DNB/Templates/maket.html"><font color="#FFFFFF">评测与市场</font></a> 
      | <a href="library/DNB/Templates/zt.html"><font color="#FFFFFF">专题版</font> 
      </a>| <a href="library/DNB/default.htm"><font color="#FFFFFF">首页</font></a></span></td>
    <td align="right" width="147" rowspan="2">&nbsp;</td>
  </tr>
  <tr> 
    <td colspan="2" bgcolor="#FFCF96" height="2"></td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center" height="48">
  <tr> 
    <td width="174" valign="bottom"><a href="library/DNB/default.htm"><img src="http://www.lpzx.edu.cn/library/DNB/Templates/tit.gif" width="169" height="68" border="0"></a></td>
    <td width="448" class="nava"><span class="nava">严正声明<br>
      　　未经许可，任何商业网站或个人网站都不得提供《电脑报》电子版的浏览或下载！违者我们将追究其法律责任！</span></td>
    <td align="right" width="148" valign="top"><a href="library/www.yesky.com/default.htm"><img src="http://www.lpzx.edu.cn/library/www.yesky.com/newimages/news/logo.gif" width="140" height="60" border="0"></a></td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center" height="11">
  <tr> 
    <td width="169" rowspan="2" valign="top">&nbsp;</td>
    <td width="141" rowspan="2" valign="top">&nbsp;</td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center">
  <tr> 
    <td colspan="3" valign="top"> <br>
      <table width="600" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <td class="nava"><font color="#FF9900">你所在的位置：&gt;&gt;<a href="library/DNB/default.htm">《电脑报》电子版</a> 
            &gt;&gt;<a href="library/DNB/Templates/index.html">2001年<!-- #BeginEditable "%B5%DA%BC%B8%C6%DA" -->第19期<!-- #EndEditable --> 
            </a>&gt;&gt;<a href="library/DNB/Templates/zt.html">专题版</a></font></td>
        </tr>
      </table>
      <table width="600" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <td> 
            <div align="center"><!-- #BeginEditable "%CE%C4%D5%C2%B1%EA%CC%E2" -->注册表及其备份与恢复<!-- #EndEditable --></div>
          </td>
        </tr>
      </table>
      <table width="600" border="1" cellspacing="0" cellpadding="5" align="center" bordercolor="#FFCC99">
        <tr> 
          <td> 
            <p><!-- #BeginEditable "%CE%C4%D5%C2%C4%DA%C8%DD" -->Windows9x取代DOS已成为操作系统的当然之选。随着功能的丰富，Windows9x所需管理的细节也远远超过DOS。用户不能仅用修改AUTOEXEC或CONFIG来调整如今Windows的配置与状态。它们需要以一种新的方式来存储、分类和编辑。于是，让无数用户“改”心大动的注册表应运而生。用户通过使用，从而更深入了解并掌握Windows9x。由于在Windows9x中采用了注册表方式，使用户可以按自己的要求对计算机系统的硬件和软件进行灵活配置。(本专题中关于注册表的一些技巧在Windows98下调试通过，有的改动后直接起作用，有的需要重新启动计算机后才生效，虽然是在Windows98下调试，但有很多技巧也适用于Windows95和Windows 
              NT)<br>
              一、Windows注册表<br>
              1.什么是注册表？<br>
              注册表是 Windows 的一个内部数据库，是一个巨大的树状分层的数据库。它容纳了应用程序和计算机系统的全部配置信息、系统和应用程序的初始化信息、应用程序和文档文件的关联关系、硬件设备的说明、状态和属性以及各种状态信息和数据。注册表中存放着各种参数，直接控制着Windows的启动、硬件驱动程序的装载以及一些Windows应用程序的运行，从而在整个Windows系统中起着核心作用。它包括如下一些内容：<br>
              (1)软、硬件的有关配置和状态信息，注册表中保存有应用程序和资源管理器外壳的初始条件、首选项和卸载数据。<br>
              (2)联网计算机的整个系统的设置和各种许可、文件扩展名与应用程序的关联关系，硬件部件的描述、状态和属性。<br>
              (3)性能记录和其它底层的系统状态信息，以及其它一些数据。<br>
              如果注册表受到了破坏，轻者使Windows在启动的过程出现异常，重者可能会导致整个系统的完全瘫痪。因此正确地认识、使用，特别是及时备份以及有问题时恢复注册表，对Windows用户来说就显得非常重要了。<br>
              2.注册表文件：.DAT<br>
              Windows98将所有注册表文件存入2个文件System.dat和User.dat中。它们是二进制文件，不能用文本编辑器打开查看。它们存于Windows目录下，具有隐含、系统和只读属性。 
              System.dat包含了计算机特定的配置数据，如安装的硬件和设备驱动程序的有关信息等。User.dat包含了用户特定的数据，如桌面设置，墙纸和窗口颜色设置等。User.dat文件的位置在以某个用户名登录时，其位于C\Windows\profiles\用户名目录下，系统同时在C\Windows目录下保留了一个缺省的User.dat文件，以备新用户使用。<br>
              说明：System.da0和User.da0这两个文件属于Windows95，是注册表的备份文件，它们在系统每次成功启动后创建。在Windows98中，注册表检查器将备份文件做成CAB文件。<br>
              二、注册表编辑器——Registry Editor<br>
              1.打开注册表编辑器<br>
              注册表的打开方式很简单，单击Windows“开始”按钮，找到“运行”，鼠标左键单击。在弹出的运行对话框中填入 regedit，按“确定”按钮即可。<br>
              我们可以看到，在注册表中，所有的数据都是通过一种树状结构以键和子键的方式组织起来，十分类似于目录结构。每个键都包含了一组特定的信息，每个键的键名都是和它所包含的信息相关的。<br>
              2.注册表编辑器的基本操作<br>
              注册表编辑器有一些基本操作命令，在这里以当前使用的Desktop为例来说明注册表编辑器的基本操作。<br>
              (1) 打开HKEY_CURRENT_USER\Control Panel\desktop\WindowMetrics，在右边的窗口中是一些名称和数据。<br>
              (2)用鼠标右键单击编辑器右边的窗格，会弹出一个快捷菜单，可以选择它来创建一个主键、一个字符串、一个二进制值或者一个DWORD值。<br>
              (3)右击编辑器左边窗格的desktop关键字，会弹出另一个快捷菜单，在这里，你可以创建一个新的主键、串值、二进制值或者DWORD值，还可以进行查找、删除和重命名等操作。<br>
              (4)双击编辑器右边的窗格中的关键字名，将会弹出一个编辑窗口，在那儿可以调整常量的值，或者删除该常量，以及进行重命名等，比如双击字符串“ScreenSaveActive”，弹出如图2的对话框。<br>
              三、注册表的备份与恢复<br>
              在安装新的应用程序或添加新硬件时都可能搞乱系统的注册表，从而引发不测，所以应该定期地备份user.dat和system.dat文件(编者：在进行注册表修改之前，强烈建议你先备份注册表，以防修改过程误操作引起系统崩溃)。<br>
              在Windows98中的Windows目录下，仍有System.dat和User.dat两个文件用来存放系统注册表信息。下面笔者就根据自己的使用体会来谈谈在Windows98中对注册表进行备份及恢复的几种常用方法。<br>
              1.直接进行备份与恢复<br>
              这是一种很原始的方法，即直接将所需之System.dat及User.dat两个文件拷贝存放在硬盘某个指定目录下或直接拷到软盘上作为备份，恢复时再将该备份替换覆盖回原处即可，当然在备份及恢复时都需对这两个文件的只读及隐藏属性进行相应的修改操作，让隐藏文件显示出来。<br>
              说明：如因注册表问题而导致系统瘫痪，开机后无法进入Windows系统时，可用应急启动盘进入Windows98自带的DOS界面后，用常规的DOS操作来将存在硬盘或软盘中的备份覆盖回原处，恢复备份的注册表数据。<br>
              2.注册表编辑器的导出与引入<br>
              运行Regedit.exe打开Windows98注册表后，利用“注册表”的“导出”及“引入”功能也可以用来备份或恢复注册表信息。具体方法为：在“注册表编辑器”窗口中点击左上角“注册表”下拉菜单，点击“导出注册表文件……”项，在出现的“导出注表文件”对话框中，键入欲备份注册表的文件名及其保存位置，再按“保存”按钮即可。需恢复注册表时，用同样的方法打开注册表编辑器，打开“注册表”下拉菜单后点击“引入注册表文件……”项，在出现的对话框中选中所需恢复的备份文件，再按“打开”按钮即可将该注表备份恢复回Windows系统了。<br>
              说明：该方法主要适合于Windows系统还未瘫痪或可以通过安全模式启动Windows98系统时恢复注册表之用，如因注册表问题而无法进入Windows系统时，则该法就无能为力了。<br>
              3.系统的注册表自动备份<br>
              在Windows98中，取消了Windows 95中每次开机时自动以System.da0和User.da0为名的两个文件来备份注册表数据的功能，而新增加了一个以.Cab(Cabinet)作后缀的压缩文件作为注册表备份的功能，具体使用如下：<br>
              该备份过程是由Windows98系统自动完成的。在用户当天第一次开机时，Windows98将会自动将系统中原有的注表信息，包括System.dat、User.dat、System.ini和Win.ini这四个文件都压缩成Cab形式的文件，在Windows\Sysbacup 
              目录下会有诸如rb000.cab和rb001.cab之类的压缩文件，这几个就是最近的五个系统备份(Windows\Sysbckup是隐藏目录，要查看须让隐藏的文件和目录显示出来)。系统自动保存最近5次开机的注册表数据。<br>
              一般说来，当Windows98安装好后，会在启动时自动运行Scanregw.exe/autorun，目的是每天备份一次注册表。你可以在开始选单上选择运行“Msconfig”，运行Microsoft的系统配置程序，点“启动”选项，查看该命令是否运行。倘若该命令没有被运行，则运行注册表编辑器“Regedit”，在“HKEY_LOCAL_MACHINE\Soft 
              ware\Microsoft\Windows\CurrentVersion\Run”主键下新建一个字符串值，键值为“C\Windows\scanregw.exe/autorun”(这里假设Windows98安装目录为C\Windows)。这样，Windows98就会自动备份最近5次的注册表，以rb00.cab形式存放在C\Windows\Sysbckup\路径下。<!-- #EndEditable --></p>
          </td>
        </tr>
      </table>
      <br>
      <br>
      <br>
    </td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center" height="4" bgcolor="#FF9900">
  <tr> 
    <td width="161" bgcolor="#99CCFF"> </td>
    <td width="610" bgcolor="#FF9900"></td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center">
  <tr> 
    <td> 
      <div align="center"><a href="library/DNB/bill/index.html" target="_blank"></a><a href="library/DNB/hdong/gao.htm" target="_blank"> 
        欢迎投稿 </a> | <a href="library/DNB/bill/index.html" target="_blank">广告联系</a>| <a href="library/DNB/serve/dnbjs.htm" target="_blank">关于我们</a>| 
        <a href="library/DNB/maillist/index.html" target="_blank">电子杂志</a>| <a href="library/DNB/hdong/zaopin.html" target="_blank">加入我们</a>| 
        <a href="library/DNB/hdong/xinsi.html" target="_blank">隐私条款</a></div>
    </td>
  </tr>
</table>
<table width="770" border="0" cellspacing="0" cellpadding="0" align="center">
  <tr> 
    <td> 
      <div align="center"><span class="nava"><font color="#000000" face="Arial, Helvetica, sans-serif"> 
        Copyright (C) 2000 Yesky.com, All Rights Reserved </font><font color="#000000"><br>
        版权所有　 <font face="Arial, Helvetica, sans-serif"> Yesky </font><br>
        <a href="mailto:webmaster@yesky.com"> 如有意见请与我们联系 </a></font></span></div>
    </td>
  </tr>
</table>
</body>
<!-- #EndTemplate -->
</html>
