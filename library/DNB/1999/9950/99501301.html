<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=utf-8'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/cpcw.css' TYPE='text/css'>
<TITLE>电脑报电子版 -- 在DELPHI编程中获取操作系统信息</TITLE>
</HEAD><BODY BGCOLOR='white'>
<A NAME='top'></A>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>

<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/yjds.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR ALIGN='Center' BGCOLOR='#CCCC99'>
<TD>
<TABLE WIDTH='100%' BORDER='0' CELLSPACING='1' CELLPADDING='1'>
<TR BGCOLOR='#CCCC99' ALIGN='Center'>
<TD BGCOLOR='#999966'><A HREF='index.html'><FONT CLASS='title'>目录</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='wrapup.html'><FONT CLASS='title'>综合报道</FONT></A></TD>
<TD BGCOLOR='#FFCC66'><FONT CLASS='title'><FONT  COLOR='#CC0000'>软件世界</FONT></FONT></TD>
<TD BGCOLOR='#999966'><A HREF='hardware.html'><FONT CLASS='title'>硬件周刊</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='internet.html'><FONT CLASS='title'>大众网络</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='oa.html'><FONT CLASS='title'>ＯＡ专刊</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='game.html'><FONT CLASS='title'>游戏广场</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='maket.html'><FONT CLASS='title'>评测与市场</FONT></A></TD>
</TR></TABLE></TD></TR></TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
<TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font>电脑报电子版 &gt; 1999 年 &gt; <A HREF='index.html'>50 期</A> &gt;  <A HREF='software.html'>软件世界</A> &gt; 在DELPHI编程中获取操作系统信息</TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR><TD><SPAN CLASS='title'>《 在DELPHI编程中获取操作系统信息 》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR><TD>　　我们日常的编程中，常常会去判断用户所使用的操作系统是什么?为什么要这么做，因为:为了使应用程序适应不同的操作系统，能让它运行得更好!如在运行某个应用程序前，应先判断用户所使用的是WIN95／98，还是WIN NT。虽然这两个都是常用的操作系统，但在某些方面是完全不同的，在WIN95／98上运行很好的程序不一定在WIN NT上也运行得很好，所以不同的操作系统应有不同的程序代码以适应不同的需要，也为了使程序运行得更好更稳定。<br>
　　那怎样才能知道用户使用的操作系统是什么呢?我们可以利用API函数来解决，方法如下：<br>
　　首先做准备工作，新建工程，在FORM1上放上一个LABEL1(CAPTION为空)与一个BUTTON1(CAPTION为获取操作系统信息)，其他属性不变，然后输入以下程序代码:<br>
　　unit GETVER;<br>
　　interface<br>
　　uses  Windows， Messages， SysUtils， Classes， Graphics， Controls， Forms， Dialogs，StdCtrls;<br>
　　type<br>
　　TForm1 = class(TForm)<br>
　　Button1: TButton;<br>
　　Label1: TLabel;<br>
　　procedure Button1Click(Sender: TObject);<br>
　　private{ Private declarations }<br>
　　public{ Public declarations }<br>
　　end;<br>
　　var  Form1: TForm1;<br>
　　implementation {＄R ＊.DFM}<br>
　　procedure TForm1.Button1Click(Sender: TObject);  ／／判断用户操作系统。<br>
　　VAR<br>
　　GETVER:OSVERSIONINFO;  ／／声明所需变量，具体内容请参考API函数说明文件。<br>
　　RET:LONGBOOL;<br>
　　begin<br>
　　GETVER.DWOSVERSIONINFOSIZE:=148;<br>
　　RET:=GETVERSIONEX(GETVER); ／／调用API函数判断开始<br>
　　IF GETVER.DWPLATFORMID=VER_PLATFORM_WIN32_WINDOWS THEN <br>
　　LABEL1.CAPTION:=′您正使用的操作系统是:WINDOWS95／98′;<br>
　　IF GETVER.DWPLATFORMID=VER_PLATFORM_WIN32_NT THEN<br>
　　LABEL1.CAPTION:=′您正使用的操作系统是:WINDOWS NT′;<br>
　　END;<br>
　　END.<br>
　　现在请运行一下(按下F9)，怎么样!是否成功?<br>
　　不清楚的地方请查看相应的API函数说明，笔者就不再赘述了!<br>
　　注：以上程序在中文WINDOWS98，DELPHI4.0 C／S版中调试通过。<br><b>
　　（上海　季昭君）</b></TD></TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD><A HREF='http://www.mydown.com/dnb/' TARGET='_blank'>下载本期推荐软件</A></TD><TD ALIGN='right'><A HREF='99501301.html#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;


</TD>
<TD> <A HREF='../../../../www_lpzx_edu_default.html'>CPCW网站</A>版权所有，<A HREF='mailto:webmaster@cpcw.com'>电脑报网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>