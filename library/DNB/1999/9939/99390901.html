<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=utf-8'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/epcw.css' TYPE='text/css'>
<TITLE>电脑报电子版 -- 用PowerBuilder制作plash窗口</TITLE>
</HEAD><BODY BGCOLOR='white'>
<A NAME='top'></A>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>

<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/loga.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR ALIGN='Center' BGCOLOR='#CCCC99'>
<TD>
<TABLE WIDTH='100%' BORDER='0' CELLSPACING='1' CELLPADDING='1'>
<TR BGCOLOR='#CCCC99' ALIGN='Center'>
<TD BGCOLOR='#999966'><A HREF='index.html'><FONT CLASS='title'>目录</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='wrapup.html'><FONT CLASS='title'>综合报道</FONT></A></TD>
<TD BGCOLOR='#FFCC66'><FONT CLASS='title'><FONT  COLOR='#CC0000'>软件世界</FONT></FONT></TD>
<TD BGCOLOR='#999966'><A HREF='hardware.html'><FONT CLASS='title'>硬件周刊</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='internet.html'><FONT CLASS='title'>大众网络</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='oa.html'><FONT CLASS='title'>ＯＡ专刊</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='game.html'><FONT CLASS='title'>游戏广场</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='maket.html'><FONT CLASS='title'>评测与市场</FONT></A></TD>
</TR></TABLE></TD></TR></TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
<TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font>电脑报电子版 &gt; 1999 年 &gt; <A HREF='index.html'>39 期</A> &gt;  <A HREF='software.html'>软件世界</A> &gt; 用PowerBuilder制作plash窗口</TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR><TD><SPAN CLASS='title'>《 用PowerBuilder制作plash窗口 》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR><TD>　　现在的大多数软件比如PowerBuilder,AuthorWare,Word等在启动时会出现一个splash窗口，在窗口上有应用程序的名称、图标、版本和其他信息，该窗口显示一定时间后会自动关闭，如果用户觉得等待的时间太长，只要用鼠标点击一下该窗口或者按任意键也可以关闭它。如果自己开发的软件在启动时也有一个splash窗口，就会给自己的增添不少色彩。下面就介绍如何利用PowerBuilder制作splash窗口的方法。<br>
　　一、 创建spalsh窗口本身<br>
　　1． 点按Windows画板，弹出Select Windows窗口，点按“New”按钮建立一个新窗口。<br>
　　2． 在新建窗口上按右键，选弹出菜单的“Properties…”，弹出Windows窗口，点General页，在Windows Type的下拉列表中选Popup，指定窗口的类型为弹出窗口，接着设置窗口的属性Visible和Enabled为TRUE，其它属性都设为FALSE。在这里要注意两点：一是窗口的Windows Type必须选Popup类型；二是要先选择窗口类型，再设置窗口的属性，不能先设置属性再选择窗口的类型。<br>
　　二、根据需要在splash窗口上放置有关信息，如：公司的名称和图标，软件的名称和版本等信息。将新建的窗口以w_splash名称保存。<br>
　　三、编写脚本以实现splash窗口显示一定时间后，自动关闭。可以通过调用Windows的timer定时器，当到达规定的时间时，向splash窗口发送一个timer事件通知关闭splash窗口来实现。<br>
　　在w_splash的open事件中编写代码(假设splash窗口保持显示状态的最长时间为10秒钟)：<br>
　　timer(10,this)／／当splash窗口打开后10秒钟，／／Windows给splash窗口发送一个timer事件<br>
　　在w_spalsh的timer事件中编写脚本：<br>
　　close(this)／／接受到timer事件后，关闭splash窗口<br>
　　在w_splash的close事件中编写脚本：<br>
　　timer(0,this)／／关闭splash窗口后，同时关掉timer事件<br>
　　四、编写脚本实现鼠标单击splash窗口时关闭该窗口。<br>
　　在w_splash的clicked事件中编写脚本close(this)<br>
　　五、编写脚本实现按任意键时关闭spalsh窗口。<br>
　　在w_splash的key事件中编写脚本：close(this)<br>
　　六、在程序启动时，首先打开主窗口，接着显示splash窗口。在应用对象的open事件中编写脚本：<br>
　　open(w_mdi_main)／／假设应用程序的主窗口称为w_mdi_main<br>
　　open(w_splash,w_mdi_main)／／打开splash窗口，它是以w_mdi_main／／为父窗口，这样就使得splash窗口显示在主窗口之上<br>
　　／／由于PowerBuilder连接数据库的时间较长，可以把连接数据库的语句<br>
　　／／放在下面，这样就使得在splash窗口显示的同时连接到数据库<br>
　　sqlca.DBMS=ProfileString(″pb.ini″,″database″,″dbms″,″″)<br>
　　sqlca.database=ProfileString(″pb.ini″,″database″,″database″,″″)<br>
　　sqlca.userid=ProfileString(″pb.ini″,″database″,″userid″,″″)<br>
　　sqlca.dbpass=ProfileString(″pb.ini″,″database″,″dbpass″,″″)<br>
　　sqlca.logid=ProfilsString(″pb.ini″,″database″,″logid″,″″)<br>
　　sqlca.logpass=ProfilsString(″pb.ini″,″database″,″LogPassWord″,″″)<br>
　　sqlca.servername=ProfilesString(″pb.ini″,″database″,″servername″,″″)<br>
　　sqlca.dbparm=ProfileString(″pb.ini″,″database″,″dbparm″,″″)
　　connect;<br>
　　if sqlca.sqlcode&lt;&gt;0 then<br>
　　MessageBox(″不能连接到数据库!″，sqlca.sqlerrtext)<br>
　　returnend if  <br>
 <b>(河北　黄万璞)</b>
</TD></TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD><A HREF='http://pcsoft.cpcw.com/recommend/1999/39/' TARGET='_blank'>下载本期推荐软件</A></TD><TD ALIGN='right'><A HREF='99390901.html#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;




</TD>
<TD> 《电脑报》版权所有，<A HREF='mailto:webmaster@cpcw.com'>电脑报网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>