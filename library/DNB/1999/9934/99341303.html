<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=utf-8'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/epcw.css' TYPE='text/css'>
<TITLE>电脑报电子版 -- VB6.0中通过MSChart控件调用数据库</TITLE>
</HEAD><BODY BGCOLOR='white'>
<A NAME='top'></A>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>

<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><IMG SRC='images/databandbanner.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR ALIGN='Center' BGCOLOR='#CCCC99'>
<TD>
<TABLE WIDTH='100%' BORDER='0' CELLSPACING='1' CELLPADDING='1'>
<TR BGCOLOR='#CCCC99' ALIGN='Center'>
<TD BGCOLOR='#999966'><A HREF='index.html'><FONT CLASS='title'>目录</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='wrapup.html'><FONT CLASS='title'>综合报道</FONT></A></TD>
<TD BGCOLOR='#FFCC66'><FONT CLASS='title'><FONT  COLOR='#CC0000'>软件世界</FONT></FONT></TD>
<TD BGCOLOR='#999966'><A HREF='hardware.html'><FONT CLASS='title'>硬件周刊</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='internet.html'><FONT CLASS='title'>大众网络</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='oa.html'><FONT CLASS='title'>ＯＡ专刊</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='game.html'><FONT CLASS='title'>游戏广场</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='maket.html'><FONT CLASS='title'>评测与市场</FONT></A></TD>
</TR></TABLE></TD></TR></TABLE>
<TABLE BORDER='0' WIDTH='468' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
<TD WIDTH='615' COLSPAN='2'><font color="#FF6666">当前位置：</font>电脑报电子版 &gt; 1999 年 &gt; <A HREF='index.html'>34 期</A> &gt;  <A HREF='software.html'>软件世界</A> &gt; VB6.0中通过MSChart控件调用数据库</TD>
</TR></TABLE>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR><TD><SPAN CLASS='title'>《 VB6.0中通过MSChart控件调用数据库 》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR><TD>　　VB6.0中的MSChart控件是一个功能强大的高级图表工具，拥有丰富的图表绘制功能，可显示二维和三维的棒图、区域图、线形图、饼图等多种常用图表。近日我为了在双击图表的某个区域时将与该区域相对应的数据库的内容在DataGrid控件上显示出来，遇到了许多困难，最后用一个自定义的变量SelectSeries解决了问题，具体方法如下：<br>
　　设数据库名称为“学生信息”，有一Access表“学生成绩”，其内容为一个班学生的考试成绩，包括学号、姓名、成绩3个字段，成绩字段格式是字符型，值为“优”、“良”、“中”、“差”中的一个。<br>
　　窗体Form1包括一个MSChart控件McScore，类型为二维饼图，用于显示每种成绩的学生数；一个ADO控件AdScore用于连接数据库；一个DataGrid控件DgScore用于以表格形式显示数据库内容。<br>
　　工作过程为：双击饼图的某个区域，则DgScore显示相应成绩的学生名单。<br>
　　代码如下：<br>
　　Option Explicit<br>
　　Dim SelectedSeries as Integer ′自定义变量<br>
　　Dim Rs() as String ′提取记录集用的字符串数组<br>
　　Private Sub Form_Load()<br>
　　′设定DataGrid控件的数据源<br>
　　DgScore.DataSource=″AdScore″<br>
　　′设定ADO控件的连接字串和初始的记录源，即显示内容<br>
　　AdScore.ConnectString=″Provider=Microsoft.OLEDB.3.51;Persist_Security Info=False;Data Source=学生信息″<br>
　　AdScore.RecordSource=″selet ＊ from学生成绩order by成绩″<br>
　　AdScore.Refresh<br>
　　′预设好提取记录用的SQL语句<br>
　　Rs(1)=″select＊ from学生成绩where成绩=″＋Chr(34)＋″优″＋_Chr(34)＋″order by成绩″<br>
	Rs(2)=″select ＊from学生成绩where成绩=″＋Chr(34)＋″良″＋_Chr(34)＋″order by成绩″<br>
	Rs(3)=″select ＊ from学生成绩where成绩=″＋Chr(34)＋″中″＋_Chr(34)＋″order by成绩″<br>
	Rs(4)=″select ＊ from学生成绩where成绩=″＋Chr(34)＋″差″_Chr(34)＋″order by成绩″<br>
	End Sub<br>
　　Private Sub McScore_SeriesSelected(Series as Integer,MouseFlags as _Integer,Cancel as Integer)<br>
	SelectedSeries=Series<br>
　　End Sub<br>
　　Private Sub McScore_PointSelected(Series as Integer,DataPoint as_Integer,MouseFlags as <br>Integer,Cancel as Integer)<br>
　　SelectedSeries=Series<br>
　　End Sub<br>
　　Private Sub McScore_Db1Click()<br>
　　′改变ADO控件的记录源并刷新<br>
　　Adoc1.RecordSource=Rs(SeletedSeries)<br>
　　Adoc1.Refresh<br>
　　End Sub　<br><b>　(湖南　高文杰)</b></TD></TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD><A HREF='http://pcsoft.cpcw.com/recommend/1999/34/' TARGET='_blank'>下载本期推荐软件</A></TD><TD ALIGN='right'><A HREF='99341303.html#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='http://www.lpzx.edu.cn/images/dot.gif' WIDTH='468' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='468' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>

<NOSCRIPT>


</NOSCRIPT>
</TD>
<TD> 《电脑报》版权所有，<A HREF='mailto:webmaster@cpcw.com'>电脑报网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>