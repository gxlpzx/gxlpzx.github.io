<HTML>
<HEAD>
<META HTTP-EQUIV='Content-Type' CONTENT='text/html; charset=utf-8'>
<META NAME='author' CONTENT='William Wan'>
<LINK REL='STYLESHEET' HREF='images/epcw.css' TYPE='text/css'>
<TITLE>电脑报电子版 -- FoxPro编程小技巧</TITLE>
</HEAD><BODY BGCOLOR='white'>
<A NAME='top'></A>
<TABLE BORDER='0' WIDTH='470' CELLSPACING='0' CELLPADDING='0' HEIGHT='6' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='top'><TD WIDTH='100%'><IMG SRC='images/dot.gif' WIDTH='470' HEIGHT='1'></TD></TR>
</TABLE><TABLE WIDTH='470' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR>
<TD WIDTH='470' BGCOLOR='#CCCC99' HEIGHT='50'><A HREF='http://www.cpcw.com' TARGET='_blank'><IMG SRC='images/cpcw.gif' WIDTH='468' HEIGHT='60' ALT='广告Logo' BORDER='0'></A></TD>
</TR>
</TABLE><TABLE BORDER='0' WIDTH='470' CELLSPACING='0' CELLPADDING='0' HEIGHT='2' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR>
<TD WIDTH='100%'><IMG SRC='images/pixel.gif' WIDTH='1' HEIGHT='1'></TD>
</TR>
</TABLE>
<TABLE WIDTH='470' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='Center'>
<TR ALIGN='Center' BGCOLOR='#CCCC99'>
<TD>
<TABLE WIDTH='100%' BORDER='0' CELLSPACING='1' CELLPADDING='1'>
<TR BGCOLOR='#CCCC99' ALIGN='Center'>
<TD BGCOLOR='#999966'><A HREF='index.html'><FONT CLASS='title'>目录</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='wrapup.html'><FONT CLASS='title'>综合报道</FONT></A></TD>
<TD BGCOLOR='#FFCC66'><FONT CLASS='title'><FONT  COLOR='#CC0000'>软件世界</FONT></FONT></TD>
<TD BGCOLOR='#999966'><A HREF='hardware.html'><FONT CLASS='title'>硬件周刊</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='internet.html'><FONT CLASS='title'>大众网络</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='oa.html'><FONT CLASS='title'>ＯＡ专刊</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='game.html'><FONT CLASS='title'>游戏广场</FONT></A></TD>
<TD BGCOLOR='#999966'><A HREF='maket.html'><FONT CLASS='title'>评测与市场</FONT></A></TD>
</TR></TABLE></TD></TR></TABLE>
<TABLE BORDER='0' WIDTH='470' CELLSPACING='0' CELLPADDING='0' HEIGHT='3' ALIGN='Center' BGCOLOR='#CCCC99'>
<TR VALIGN='bottom'>
<TD WIDTH='100%'><IMG SRC='images/dot.gif' WIDTH='470' HEIGHT='1'></TD>
</TR></TABLE>
<TABLE WIDTH='470' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='Center'>
<TR>
<TD WIDTH='470' COLSPAN='2'><font color="#FF6666">当前位置：</font><A HREF='http://www.cpcw.com/issue/'>电脑报电子版</A> &gt; <A HREF='http://www.cpcw.com/issue/1999/'>1999 年</A> &gt; <A HREF='index.html'>28 期</A> &gt;  <A HREF='software.html'>软件世界</A> &gt; FoxPro编程小技巧</TD>
</TR></TABLE>
<TABLE WIDTH='470' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'><TR ALIGN='center' VALIGN='bottom'><TD HEIGHT='6'><IMG SRC='images/dot.gif' WIDTH='470' HEIGHT='1'></TD></TR></TABLE>
<BR><TABLE WIDTH='470' BORDER='0' CELLSPACING='0' CELLPADDING='2' BGCOLOR='#FFCC66' ALIGN='center'>
<TR><TD><SPAN CLASS='title'>《 FoxPro编程小技巧 》</SPAN></TD>
</TR></TABLE><BR><TABLE WIDTH='470' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR><TD>　　<b>1．在VFP5.0的报表设计器中，通过编程实现打印数据颜色的变化（如：正数打印黑色，负数打印红色等）</b><br>
　　对同一个变量（字段），如金额，在报表上做两个域控件，它们是重叠的，一个黑色，一个红色，双击红色控件调出报表表达式设置框，按“打印条件”，在出现的设置框中的“仅当下列表达式为真时打印”中输入“金额&lt;0”，同理黑色的就输入“金额&gt;=0”，这样大于等于0就打印黑色的，反之打印红色的。<br>
　　<b>2．制作VFP5.0安装程序，使其运行安装结束后在“开始”菜单上建立程序组</b><br>
　　如果在向导的第6步中没有指定程序管理器项，就应该将.exe文件指定为程序管理器项，单击该文件所在行的程序管理器项中的check按钮，在弹出的窗口中输入说明和命令行，命令行输入：％s\xxx.exe，xxx.exe为您的.exe文件名，％s是为了保证程序在安装时改变了目录也能正常运行，另还可选择图标。<br>
　　<b>3．将程序中随机生成的表或游标加入到数据环境中，并用表格控件显示</b><br>
　　1）表格与数据环境中一个表A对应，程序中随机生成表B后，将表A清空，将B的数据全部放入A。<br>
　　2）表格以及列的ControlSource不要设数据表别名，列的ControlSource只有字段名，那么当程序随机生成表的字段与表对应上以后就可以显示了。<br>
　　3）以上两种方法适用于编程时知道随机表的字段情况，如字段都是随机的，无法预先知道，那么就只有用表格的addcolumn方法，即根据随机生成的表临时向表格中添加列。当然预先知道字段的情况下也可用此方法。<br>
　　另外可以使用视图或者使用SQL语言。<br>
　　<b>4．将winhelp写的帮助文件连接到菜单上</b><br>
			      　　当然你可以把菜单名改为“帮助主题”，或者其它名字都可以，然后用如下命令：set hlp to xxx.hlp把系统帮助文件设为你的文件(xxx.help为你的帮助文件名)。&gt;
　　在你的程序菜单中用“插入栏”插入“Microsoft Visual FoxPro 帮助主题<br>
　　5．通过OLE控件和宏实现数据表内GENERAL字段中的图片自动备份到硬盘上<br>
　　1）制作一个宏，{alt＋f}a；<br>
　　2）添加OLE控件，在表单中执行方法DoVerb，如：thisform.OleObject.DoVerb(－1)；<br>
　　3）然后播放宏，就可以得到“另存为”窗口；<br>
　　4）可以在表单上添加一些按钮，便于操作；<br>
　　5）如果知道OLE服务器的动作集，在DoVerb直接送参数就可以实现自动存盘。<br><b>（风帆）</b></TD></TR></TABLE><TABLE WIDTH='470' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR>
<TD><A HREF='http://pcsoft.cpcw.com/recommend/1999/28/' TARGET='_blank'>下载本期推荐软件</A></TD><TD ALIGN='right'><A HREF='99281302.html#top'>页 首</A></TD>
</TR></TABLE><BR>
<TABLE WIDTH='470' BORDER='0' CELLSPACING='0' CELLPADDING='0' ALIGN='center'>
<TR ALIGN='center' VALIGN='bottom'>
<TD HEIGHT='6'><IMG SRC='images/dot.gif' WIDTH='470' HEIGHT='1'></TD>
</TR></TABLE><TABLE WIDTH='470' BORDER='0' CELLSPACING='0' CELLPADDING='2' ALIGN='center'>
<TR ALIGN='center'>
<TD>&nbsp;


</TD>
<TD> <A HREF='http://www.cpcw.com'>《电脑报》</A>版权所有，<A HREF='mailto:webmaster@cpcw.com'>电脑报网站编辑部</A>设计制作发布</TD>
</TR>
</TABLE></BODY></HTML>