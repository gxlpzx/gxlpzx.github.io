<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style type="text/css">
<!--
        A:link {text-decoration: none; color: blue}
        A:visited {text-decoration: none; color: blue}
        A:active {text-decoration: red}
        A:hover {text-decoration: underline; color:red}
        P,td,li{font-family: 宋体; font-size: 9pt}
        
        h1{font-family: 宋体; font-size: 11pt}
-->
</style>
<title>《编程爱好者》电子杂志第50期</title>
</head>

<body bgcolor="ffffcc">
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" height="74"
bordercolorlight="#000000" bordercolordark="#FFFFFF">
  <tr>
    <td width="496" height="70"><p align="center"><strong><a name="top"><font size="5"
    face="楷体_GB2312" color="#008040">编</font><font color="#008000" size="5"
    face="楷体_GB2312"> </font><font size="5" face="楷体_GB2312" color="#FF00FF">程</font><font
    color="#008000" size="5" face="楷体_GB2312"> <font color="#0000A0">爱</font> <font
    color="#800080">好</font> </font><font size="5" face="楷体_GB2312" color="#FF0000">者</a><br>
    </font><font color="#FF8000">一份面向广大编程爱好者的免费电子杂志</font></strong></p>
    <p align="center"><strong>总第50期</strong>　2000/05/28 　星期日&nbsp;&nbsp; 
    本期发送数: 9800</p>
    <p align="center">【<a href="http://www.pfan.net" target="_blank">杂志首页</a>】　【<a
    href="mailto:yaoz@citiz.net">编辑信箱</a>】　【<a
    href="mailto:yaoz@citiz.net?subject=question">提问信箱</a>】　【<a
    href="50.htm#subscribe">杂志订退</a>】</td>
  </tr>
</table>
</div>

<p><strong>特别推荐</strong><font color="#FF0000">：编程爱好者网站最新收录“爱虫”病毒源代码，现在仅提供给本杂志的用户。<br>
本源代码仅供学习之用，不可进行任何破坏活动，一切后果由本人负责。</font><a
href="http://www.pfan.net/iloveyou.htm" target="_blank">&gt;&gt;按此查看</a></p>

<h1><font color="#FF0000"><span style="background-color: rgb(0,255,255)">本期栏目内容</span></font></h1>

<p><a href="50.htm#ksy"><strong>刊首语</strong></a></p>

<p><a href="50.htm#wyzp"><strong>网友作品</strong></a>

<ul>
  <li><font color="#0000FF">汉软日历（国际通用版）</font></li>
  <li><font color="#0000FF">BCBClean</font></li>
  <li><font color="#0000FF">消息机</font></li>
  <li><font color="#0000FF">Net Tools 1.2.2000.0508</font></li>
</ul>

<p><strong><a href="50.htm#jswz">技术文章</a></strong>

<ul>
  <li><a href="50.htm#1">用VB6的双通道技术获得影碟片断</a></li>
  <li><a href="50.htm#2">让DELPHI与OFFICE联姻</a></li>
  <li><a href="50.htm#3">利用任务栏上的图标与用户交互</a></li>
  <li><a href="50.htm#4">VB编程获取文件中集成的图标</a></li>
  <li><a href="50.htm#5">监视剪贴板内容</a></li>
  <li><a href="50.htm#6">巧用JavaScript记录网站访问次数</a></li>
</ul>

<p><a href="50.htm#xzzq"><strong>下载专区</strong></a>

<ul>
  <li>WinHEX 9.38</li>
  <li>Help &amp; Manual 2.52</li>
  <li>Quick Install Maker 2000 V2.22</li>
  <li>Xtreeme InstallXpert V2.0</li>
  <li>Applet Button Factory 5.1</li>
</ul>

<p><a href="50.htm#ywbd"><strong>有问必答</strong></a></p>

<p><a href="50.htm#zzxx"><strong>杂志信息</strong></a></p>

<p><strong>特别推荐</strong><font color="#FF0000">：编程爱好者网站最新收录“爱虫”病毒源代码，现在仅提供给本杂志的用户。<br>
本源代码仅供学习之用，不可进行任何破坏活动，一切后果由本人负责。</font><a
href="http://www.pfan.net/iloveyou.htm" target="_blank">&gt;&gt;按此查看</a></p>

<h1><font color="#ff0000"><span style="BACKGROUND-COLOR: rgb(0,255,255)"><a name="ksy">刊 
首 语</a></span></font></h1>
<div align="left">

<table border="1" borderColorDark="#ffffff" borderColorLight="#000000" cellPadding="0"
cellSpacing="0" height="95" width="500">
<TBODY>
  <tr>
    <td bgColor="#ffc993" height="62">&nbsp;&nbsp;&nbsp; <a href="http://www.pfan.net"
    target="_blank">编程爱好者网站</a>倾力推出又一份全新的电子杂志<font
    color="#FF0000">《编程爱好者之雕虫小技专刊》</font>，主要以刊登各类编程开发语言中的小技巧为主，目前定在每周三、日发送，欢迎到编程爱好者网站上进行订阅。<br>
    &nbsp;&nbsp;&nbsp; <a href="http://www.pfan.net" target="_blank">编程爱好者网站</a>书籍下载栏目将陆续推出大量编程书籍资料下载。欢迎光临。</td>
  </tr>
  <tr>
    <td height="15"><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</TBODY>
</table>
</div>

<p>　</p>

<h1><a name="wyzp"><font color="#FF0000"><span style="background-color: rgb(0,255,255)">网 
友 作 品</span></font></a></h1>
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" bordercolordark="#FFFFFF"
bordercolorlight="#000000" height="114">
  <tr>
    <td bgcolor="#FFC993" height="81">&nbsp;&nbsp;&nbsp; <font color="#800080">您自己开发过软件吗? 
    您有自己满意的作品吗? 您希望发布推广您的作品吗? 
    本刊竭诚为您提供宣传空间。有意的朋友请把您的作品介绍以及下载地址、您的网址、电子邮件及相关信息发往 
    </font><a href="mailto:yaoz@citiz.net?subject=发布作品">yaoz@citiz.net?subject=发布作品</a><font
    color="#800080">（具体可以参照下面）。本刊免费为您宣传三期。如果您暂时没有个人主页，您可以将您的作品发给我，本站将竭诚为您提供存放空间。如还有疑问可以与我联系。</font></td>
  </tr>
  <tr>
    <td height="12">　<p><font color="#0000FF"><strong>汉软日历（国际通用版）</strong></font><br>
    最新版本：6.0<br>
    文件大小：362K<br>
    软件性质：免费软件<br>
    作 者：徐晓伟<br>
    软件主页： <br>
    <a href="http://person.zj.cninfo.net/~HAMSoft/">http://person.zj.cninfo.net/~HAMSoft/</a><br>
    <a href="http://my.szptt.net.cn/xuer/">http://my.szptt.net.cn/xuer/</a><br>
    下载地址：<br>
    <a href="http://my.szptt.net.cn/xuer/soft/rili6.zip">http://my.szptt.net.cn/xuer/soft/rili6.zip</a><br>
    <a href="http://person.zj.cninfo.net/~HAMSoft/soft/rili6.zip">http://person.zj.cninfo.net/~HAMSoft/soft/rili6.zip</a><br>
    应用平台：Windows95/98/NT4/Win2000<br>
    更新日期：2000-5-25<br>
    简介： <br>
    汉软日历2000 6.0 国际通用版继承了原 5.8 
    版本的全部优点，自带字库，实现全球通。<br>
    汉软日历2000 6.0 增加了整点、半点报时功能。报时时，PC机内置喇叭会发出广播里常听到的“DI-DU”的响声。<br>
    汉软日历是为弥补 Windows 95/98/Win2000 
    中“日期”年份范围小、又没有农历的不足而开发的。<br>
    汉软日历中使用的农历数据来自气象出版社的《通用万年历》(书号ISBN 
    7-5029-1286-X/Z.0087)。起始年自1901年，至2060年为止，共160年。</p>
    <p>　</p>
    <p><font color="#0000ff"><strong>BCBClean</strong></font> <br>
    软件大小: 170,496bytes<br>
    作者: minuteman<br>
    Email: <a href="mailto:minuteman@263.net">minuteman@263.net</a><br>
    下载地址： <a href="http://go.163.com/~minute/soft/bcbcln.exe">http://go.163.com/~minute/soft/bcbcln.exe</a><br>
    用于清除BCB编程以及编译过程产生的无用文件，可以自己定制需清除的文件扩展名。</p>
    <p>　</p>
    <p><font color="#0000ff"><strong>消息机</strong></font><br>
    软件大小: 161,792bytes<br>
    作者: minuteman<br>
    Email: <a href="mailto:minuteman@263.net">minuteman@263.net</a><br>
    下载地址： <a href="http://go.163.com/~minute/soft/MsgV2.exe">http://go.163.com/~minute/soft/MsgV2.exe</a><br>
    基于UDP的消息发送程序，可以在IP网上有确定地址的PC间传递短消息。</p>
    <p>　</p>
    <p><font color="#0000ff"><strong>Net Tools</strong></font><br>
    软件版本：1.2.2000.0508<br>
    运行环境：Win98/WinNT<br>
    软件大小：376k<br>
    软件作者：NowCan<br>
    E-Mail ： <a href="mailto:nowcan@126.com">nowcan@126.com</a><br>
    下载地址：<br>
    软件类型：Internet 辅助，免费软件。<br>
    软件简介：查看本机IP地址、网卡地址及Winsocket的信息，查看所有TCP连接信息（包括：本地地址、端口，远程地址、端口，状态），地址解析，Trace 
    route，以及IP、ICMP、UDP、TCP数据包的统计数据。注意：Win95/97须升级Winsock2才可运行。</p>
    <p>　</td>
  </tr>
  <tr>
    <td height="15"><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</table>
</div>

<p>　</p>

<h1><span style="background-color: rgb(0,255,255)"><font color="#FF0000"><a name="jswz">技 
术 文 章</a></font></span></h1>
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" bordercolordark="#FFFFFF"
bordercolorlight="#000000">
  <tr>
    <td bgcolor="#FFC993" align="center"><strong><a name="1">用VB6的双通道技术获得影碟片断<br>
    </a><br>
    河南 新天</strong></td>
  </tr>
  <tr>
    <td>　<p>　　 现在计算机多媒体技术的发展,使影碟无需借助解压卡就可以在电脑中播放,而且由于vcd2.0标准的普及,影碟已经完成了向数字文件化的过渡,完全可以轻松的将任何vcd拷贝到自己的硬盘上欣赏,而无须辛苦娇嫩的光驱.这也为我们截取任何影碟的片断提供了可能.但是目前普遍采用的压缩成AVI文件的办法不仅体积庞大、画面停滞而且速度非常慢。笔者在总结编写文件分割软件的经验基础上,辟出了一条蹊径,即采用双通道技术直接截取影碟文件片断,从根本上克服了上述弊端。<br>
    　　(一)编程原理;<br>
    　　一般来说VCD的实际影音文件放在光盘根目录下“MPEGAV”子目录下，文件名为music001.dat或者依次排序,通过对该文件的截取操作，使用户可以保存任何精彩的影碟片断，据作者测算，每十兆字节大约可以播放一分钟，这样，用户可以使用该软件截取任意时间段内的vcd，不过要使用“超级解霸”5.02以上版本播放。<br>
    　　由于影音文件体积非常大,普通vcd2.0格式60分钟的影音文件长度在600兆以上,因此采用单通道定义二进制数组的办法不仅可靠性差,而且截取较长片断时势必难以实现.笔者采用了双通道技术,即通过定义较小的固定二进制数组,一个通道用来读取,另一个通道用来写入的方法来实现.这其中涉及了复杂的二进制定位技术。<br>
    　　(二)编程实例;<br>
    　　（第一步)启动vb6中文版建立一个标准exe工程,将窗体命名为“form1&quot;,单击“工程&quot;菜单项目,选择“部件&quot;,在部件对话框的“控件&quot;栏目中选择“MICROSOFT 
    WINDOWS COMMON CONTROLS 6.0&quot;,确认在它前面的复选框中有一个黑色的对号,单击“确认&quot;,添加对该控件的引用.添加6个标签框,4个文本框(由上直下依次排列),3个按钮,一个进度条命名为ba1,一个公用对话框控件命名为cog1,拖动控件到适当位置,界面设计完成后大致如图1所示。其中, 
    “影音文件名称:&quot;标签对应text1,“影音文件长度:&quot;标签对应text2,“截取起始位置:”标签对应text3,“截取长度:”标签对应text4,“截取后文件保存路径:”标签对应text5.设置Label6的BorderStyle 
    = 1,“浏览(＊.dat)”按钮对应Command1 ,“保存为(＊.dat)&quot;按钮对应Command2 
    ,“开始截取&quot;按钮对应Command3 。<br>
    　　双击窗体添加以下代码:<br>
    　　Private Sub Command1_Click() '浏览选择文件<br>
    　　Cog1.FileName = “&quot; '清空过期文件名称<br>
    　　Cog1.Filter =“vcd影碟文件(＊.dat)|＊.dat&quot; '只保留影碟文件<br>
    　　Cog1.ShowOpen '执行打开操作<br>
    　　If Cog1.FileName &lt;&gt; &quot;&quot; Then '如果放弃就忽略操作<br>
    　　Text1.Text = Cog1.FileName '得到被截取文件名<br>
    　　Label6.Caption = CInt(FileLen(Text1.Text) / 2 ^ 20) '将文件长度转化为兆字节<br>
    　　End If<br>
    　　End Sub<br>
    　　Private Sub Command2_Click() '保存为<br>
    　　If Text1.Text = “&quot; Then '如果未选定影音文件就拒绝操作,显示提示信息<br>
    　　MsgBox “请首先选择一个被截取的文件!&quot;, vbOKOnly ＋ vbExclamation<br>
    　　Exit Sub '中断操作<br>
    　　End If<br>
    　　Cog1.FileName = “&quot;<br>
    　　Cog1.ShowSave<br>
    　　If Cog1.FileName &lt;&gt; “&quot; Then<br>
    　　Text4.Text = Cog1.FileName '保存路径名称<br>
    　　End If<br>
    　　End Sub<br>
    　　Private Sub Command3_Click() '开始截取操作<br>
    　　Dim err_descr As String<br>
    　　If Text1.Text = “&quot; Or Text2.Text = “&quot; Or Text3.Text = “&quot; Or 
    Text4.Text = “&quot; Then '再次验证参数正确性<br>
    　　MsgBox “请依次输入正确的信息,不要有所遗漏!&quot;, vbOKOnly ＋ 
    vbExclamation<br>
    　　Exit Sub '如果参数不完整忽略操作<br>
    　　End If<br>
    　　If Not jieQU(Text1.Text, Text2.Text, Text3.Text, Text4.Text) Then '执行截取失败<br>
    　　MsgBox “红箭提示信息:&quot; ＆ err_descr, vbOKOnly ＋ vbExclamation '返回错误信息<br>
    　　Else '执行截取成功<br>
    　　MsgBox“红箭提示信息:文件截取操作已经圆满完成!&quot;, vbOKOnly 
    ＋ vbExclamation<br>
    　　End If<br>
    　　End Sub<br>
    　　Private Sub Form_Load()<br>
    　　Me.Caption = App.Title<br>
    　　Me.Left = (Screen.Width － Me.Width) / 2<br>
    　　Me.Top = (Screen.Height － Me.Height) / 2 '窗体居中<br>
    　　End Sub<br>
    　　Private Sub Form_Unload(Cancel As Integer)<br>
    　　End '结束工程<br>
    　　End Sub<br>
    　　(第二步)添加一个模块,输入以下代码:<br>
    　　Option Explicit '变量检查<br>
    　　Type FileSection<br>
    　　Bytes() As Byte '定义关键数组<br>
    　　End Type<br>
    　　Type SectionedFile<br>
    　　Files() As FileSection '定义辅助数组<br>
    　　End Type<br>
    　　Public Function jieQU(Yname As String, Kshi As Long, CHang As Long, Bname As String) 
    As Boolean '定义截取操作函数<br>
    　　Form1.MousePointer = 11 '设置鼠标指针为漏斗型<br>
    　　jieQU = True '函数成功标志<br>
    　　Dim mlp As Integer, i As Integer, zhi As Long, fnum As Integer, fnum1 As Integer<br>
    　　Dim shuZU As Long, myfile As SectionedFile<br>
    　　shuZU = 2000000 '定义内存固定数组,长度为2兆<br>
    　　Kshi = Kshi ＊ 2 ^ 20 <br>
    　　'转换文件指针单位为字节<br>
    　　CHang = CHang ＊ 2 ^ 20 <br>
    　　 '转换文件长度单位为字节<br>
    　　If CHang &lt; shuZU Then <br>
    　　'如果截取长度太小<br>
    　　MsgBox “截取的文件长度不能小于2兆字节!&quot;, vbOKOnly ＋ 
    vbExclamation<br>
    　　jieQU = False <br>
    　　'返回操作失败标志,退出操作<br>
    　　Exit Function<br>
    　　End If<br>
    　　If CInt(CHang / shuZU) &gt;= CHang / shuZU Then<br>
    　　mlp = CInt(CHang / shuZU) <br>
    　　Else<br>
    　　mlp = CInt(CHang / shuZU) ＋ 1<br>
    　　End If <br>
    　　'计算需要进行操作的次数<br>
    　　fnum1 = FreeFile'返回第一个空闲文件通道<br>
    　　Open Bname For Binary As ＃fnum1 '以二进制方式打开影音文件<br>
    　　ReDim myfile.Files(1) '重新分配内存辅助数组<br>
    　　With Form1.Ba1<br>
    　　.Visible = True<br>
    　　.Value = 0<br>
    　　.Max = mlp<br>
    　　.Min = 0 '展示进度条,提示操作进度<br>
    　　For i = 1 To mlp '读取和写入数据<br>
    　　zhi = Kshi ＋ (－1 ＋ i) ＊ shuZU '计算第一个二进制通道指针<br>
    　　If i &lt; mlp Then '如果不是最后一次操作<br>
    　　ReDim myfile.Files(1).Bytes(1 To shuZU) '定义主要内存数组2兆字节<br>
    　　fnum = FreeFile '打开第二个空闲文件通道<br>
    　　Open Yname For Binary As ＃fnum '以二进制方式打开被截取的影音文件<br>
    　　Seek ＃fnum, zhi '指针定位<br>
    　　Get ＃fnum, , myfile.Files(1).Bytes '获取数据<br>
    　　Close ＃fnum<br>
    　　Else '如果是最后一次操作<br>
    　　ReDim myfile.Files(1).Bytes(1 To (CHang － (mlp － 1) ＊ shuZU)) '分配主要内存数组大小为最后遗留数据大小<br>
    　　fnum = FreeFile<br>
    　　Open Yname For Binary As ＃fnum<br>
    　　Seek ＃fnum, zhi '定位指针<br>
    　　Get ＃fnum, , myfile.Files(1).Bytes<br>
    　　Close ＃fnum<br>
    　　End If<br>
    　　Put ＃fnum1, , myfile.Files(1).Bytes '以二进制方式写入保存文件<br>
    　　.Value = i '进度条开始运行<br>
    　　Next '循环直到操作次数全部执行<br>
    　　Close ＃fnum1 '关闭文件通道<br>
    　　.Visible = False '隐藏进度条<br>
    　　 End With<br>
    　　 Form1.MousePointer = 0 '还原鼠标指针指针<br>
    　　End Function<br>
    　　(第三步)运行调试工程,如图2。<br>
    　　（第四步)编译。<br>
    　　怎么样,现在一个精致的非常实用的先进的(不是夸口)vcd截取软件已经制作成功了（如图3）,你现在可将那些什么avi压缩工具放进回收站了。心动不如行动,此程序在vb6.0中文企业版/windows98中调试通过,如果你用的是vb5.0那么也不用担心,你只用将第一步中对部件的引用改为“MICROSOFT 
    WINDOWS COMMON CONTROLS 5.0&quot;即可。</p>
    <p>　</td>
  </tr>
  <tr>
    <td><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</table>
</div>

<p>　</p>
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" bordercolordark="#FFFFFF"
bordercolorlight="#000000">
  <tr>
    <td bgcolor="#FFC993"><p align="center"><a name="2"><strong>让DELPHI与OFFICE联姻</strong></a></td>
  </tr>
  <tr>
    <td>　<p>　　由于微软的Office系列的完善的功能；与Windows和IE的紧密集成以及强大的扩展能力，它实际上已经成为事实上的Windows下办公软件的标准，我们知道在VB中可以建立各种Office对象（Word、Excel）并控制这些对象编辑、打印、保存文档以及控制执行Office中的很多操作。象这样在VB中建立并控制Office对象是十分有用的，例如你可以将一个或者一批数据库自动输入到Word或者Excel中并保存，再通过Outlook将文档分发给其它同仁。<br>
    　　过去，这只有通过VB才能实现的，但是现在Delphi5也提供了这样强大的对象组。利用Delphi也可以利用Office资源了。<br>
    　　打开Delphi，滚动Compent Palette到Servers页，就可以看到很多熟悉的控件图标，这些就是Office组件的控件。Delphi 
    5中对应Office的组件包括了Word、Excel、Access、PowerPoint和Outlook可以说是十分的全面。不过要使用这些组件首先要保证你的系统中安装了Office 
    97或以上的 版本。<br>
    　　下面首先来说以下Office组件的基本使用方法Delphi中对于Office中不同的组件，首先要建立一个Application对象，例如要控制Word，首先要建立TWordApplication对象，然后再将诸如TWordDocument等Word对象通过ConnectTo方法连接到TWordApplication对象上。对于其它的Excel、Outlook等也是如此。<br>
    　　下面我通过具体的范例来说明对Delphi中Office对象的控制，即如何将文字输出到Word中进行简单的排版并保存和打印输出。<br>
    　　首先建立一个新的工程，在Form1中加入三个TButton对象、一个TMemo对象、一个TWordApplication对象、一个TWordDocument对象、一个TWordFont对象。下面是Form1的代码：<br>
    　　unit Unit1;<br>
    　　interface<br>
    　　uses<br>
    　　Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,<br>
    　　StdCtrls, ExtCtrls, Word97, OleServer,Clipbrd;<br>
    　　type<br>
    　　TForm1 = class(TForm)<br>
    　　Memo1: TMemo;<br>
    　　Button1: TButton;<br>
    　　WordApplication1: TWordApplication;<br>
    　　WordDocument1: TWordDocument;<br>
    　　WordFont1: TWordFont;<br>
    　　Button2: TButton;<br>
    　　Button3: TButton;<br>
    　　procedure FormCreate(Sender: TObject);<br>
    　　procedure Button1Click(Sender: TObject);<br>
    　　procedure Button2Click(Sender: TObject);<br>
    　　procedure Button3Click(Sender: TObject);<br>
    　　private<br>
    　　{ Private declarations }<br>
    　　public<br>
    　　{ Public declarations }<br>
    　　end;<br>
    　　var<br>
    　　Form1: TForm1;<br>
    　　implementation<br>
    　　{＄R ＊.DFM}<br>
    　　procedure TForm1.FormCreate(Sender: TObject);<br>
    　　begin<br>
    　　Button1.Caption := '插入到Word';<br>
    　　Button2.Caption := '打印';<br>
    　　Button3.Caption := '退出';<br>
    　　Button2.Enabled :=False;<br>
    　　Button3.Enabled :=False;<br>
    　　end;<br>
    　　procedure TForm1.Button1Click(Sender: TObject);<br>
    　　var<br>
    　　Template,NewTemplate,ItemIndex:OleVariant;<br>
    　　procedure setfont;<br>
    　　begin<br>
    　　WordFont1.ConnectTo(WordDocument1.Sentences.Get_Last.Font);<br>
    　　WordFont1.Bold := 1;<br>
    　　WordFont1.Italic := 1;<br>
    　　WordFont1.shadow := 1;<br>
    　　WordFont1.Size := 12;<br>
    　　end;<br>
    　　begin<br>
    　　try<br>
    　　Template := EmptyParam;<br>
    　　NewTemplate := True;<br>
    　　ItemIndex := 1;<br>
    　　try<br>
    　　Wordapplication1.Connect;<br>
    　　except<br>
    　　MessageDlg('无法连接，也许没有安装Word', mtError, [mbOk], 0);<br>
    　　Abort;<br>
    　　end;<br>
    　　Wordapplication1.Visible := False;<br>
    　　WordApplication1.Caption := 'Delphi Word';<br>
    　　//建立一个新文档<br>
    　　Template := EmptyParam;<br>
    　　NewTemplate := False;<br>
    　　WordApplication1.Documents.Add(Template, NewTemplate);<br>
    　　//建立WordDocument连接<br>
    　　WordDocument1.ConnectTo(WordApplication1.Documents.Item(ItemIndex));<br>
    　　//因为Word进行拼写检查需要很多时间，所以首先关闭检查<br>
    　　WordApplication1.Options.CheckSpellingAsYouType := False;<br>
    　　WordApplication1.Options.CheckGrammarAsYouType := False;<br>
    　　//将Memo1的内容拷贝到Word中<br>
    　　SetFont;<br>
    　　WordDocument1.Range.InsertAfter('Memo1的文本: ' ＋ ＃13＋Memo1.Text ＋ ＃13);<br>
    　　Button2.Enabled :=True;<br>
    　　Button3.Enabled :=True;<br>
    　　Button1.Enabled :=False;<br>
    　　except<br>
    　　on E: Exception do<br>
    　　begin<br>
    　　ShowMessage(E.Message);<br>
    　　WordApplication1.Disconnect;<br>
    　　end;<br>
    　　end;<br>
    　　end;<br>
    　　procedure TForm1.Button2Click(Sender: TObject);<br>
    　　begin<br>
    　　WordDocument1.PrintOut;<br>
    　　end;<br>
    　　procedure TForm1.Button3Click(Sender: TObject);<br>
    　　var<br>
    　　SaveChanges,OriginalFormat,RouteDocument,SavePath: OleVariant;<br>
    　　begin<br>
    　　SaveChanges := WdDoNotSaveChanges;<br>
    　　OriginalFormat := UnAssigned;<br>
    　　RouteDocument := UnAssigned;<br>
    　　try<br>
    　　SavePath:='c:\samp.doc';<br>
    　　WordDocument1.SaveAs(SavePath);<br>
    　　WordDocument1.Close;<br>
    　　WordDocument1.Disconnect;<br>
    　　WordApplication1.Quit(SaveChanges, OriginalFormat, RouteDocument);<br>
    　　WordApplication1.Disconnect;<br>
    　　close;<br>
    　　except<br>
    　　on E: Exception do<br>
    　　begin<br>
    　　Showmessage(E.Message);<br>
    　　WordApplication1.Disconnect;<br>
    　　end;<br>
    　　end;<br>
    　　end;<br>
    　　end.<br>
    　　运行程序，在Memo1中输入一些文字，点击“插入到Word”按钮，然后点击“打印”按钮就可以将由Memo1输入到Word中的文本打印出来。点击“退出”按钮就可以将文档保存到 
    c:\samp.doc 中然后关闭与Word的连接并退出。<br>
    　　由上面的范例可以看到，Delphi对于Office组件的编程同VB是有一些相似的，由于不知道什么原因，Delphi并没有提供Office组件的帮助文档。上面的程序我是一点点摸索出来的，但是如果你掌握了Office组件的编程技巧，加上Delphi强大的功能，一定会使你的程序如虎添翼的。<br>
    　　以上程序在Windows98、Windows2000，Delphi5.0，Office2000下运行通过。</p>
    <p>　</td>
  </tr>
  <tr>
    <td><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</table>
</div>

<p>　</p>
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" bordercolordark="#FFFFFF"
bordercolorlight="#000000">
  <tr>
    <td bgcolor="#FFC993" align="center"><strong><a name="3">利用任务栏上的图标与用户交互</a> 
    <br>
    <br>
    四川 曾成</strong></td>
  </tr>
  <tr>
    <td>　<p>　　 
    我们有时需要编制一些仅在后台监控的程序，为了不干扰前台程序的运行界面和不显示不必要的窗口，应使其运行时的主窗口不可见。同时，应该让用户知道该程序正在运行，并且达到与用户进行交互的目的。将一个图标显示在任务栏右端静态通告区中并响应用户的鼠标动作是当前非常流行的方法，它体现了Windows 
    95友好的界面风格。下面以一个SDI（单文档界面）程序为例，讲述采用Microsoft 
    Visual C＋＋ 5.0开发这类程序的主要步骤。<br>
    　　 
    首先，要使程序的主窗口不可见，并且不在任务栏上出现任务按钮，要做到这两点，需分别设置主边框窗口的风格和扩展风格：<br>
    　　BOOL CMainFrame::PreCreateWindow(CREATESTRUCT＆ cs)<br>
    　　{<br>
    　　cs.style =WS_POPUP;//使主窗口不可见<br>
    　　cs.dwExStyle |=WS_EX_TOOLWINDOW;//不显示任务按钮<br>
    　　return CFrameWnd::PreCreateWindow(cs);<br>
    　　}<br>
    　　其次，利用系统函数Shell_NotifyIcon将一个图标显示在任务栏的通告区中。该函数的原型为：<br>
    　　WINSHELLAPI BOOL WINAPI Shell_NotifyIcon(<br>
    　　DWORD dwMessage, <br>
    　　PNOTIFYICONDATA pnid <br>
    　　); <br>
    　　下例中被显示的是主边框窗口的图标，实际上可以显示任何图标：<br>
    　　int CMainFrame::OnCreate(LPCREATESTRUCT lpCreateStruct)<br>
    　　{<br>
    　　…<br>
    　　NOTIFYICONDATA tnd;<br>
    　　tnd.cbSize=sizeof(NOTIFYICONDATA);<br>
    　　tnd.hWnd=this－&gt;m_hWnd;<br>
    　　tnd.uID=IDR_MAINFRAME;<br>
    　　tnd.uFlags=NIF_MESSAGE|NIF_ICON|NIF_TIP;<br>
    　　tnd.uCallbackMessage=WM_LIBEN;<br>
    　　tnd.hIcon=LoadIcon(AfxGetInstanceHandle(),MAKEINTRESOURCE(IDR_MAINFRAME));<br>
    　　strcpy(tnd.szTip,&quot;提示信息&quot;);<br>
    　　Shell_NotifyIcon(NIM_ADD,＆tnd);<br>
    　　…<br>
    　　}<br>
    　　在调用该函数之前，需要确定其参数的取值，其中之一为一个具有NOTIFYICONDATA类型的结构。其原型为：<br>
    　　typedef struct _NOTIFYICONDATA { // nid<br>
    　　DWORD cbSize;<br>
    　　HWND hWnd;<br>
    　　UINT uID;<br>
    　　UINT uFlags;<br>
    　　UINT uCallbackMessage;<br>
    　　HICON hIcon; <br>
    　　charszTip[64]; }<br>
    　　NOTIFYICONDATA, ＊PNOTIFYICONDATA; <br>
    　　在该结构的成员中，cbSize为该结构所占的字节数，hWnd为接受该图标所发出的消息的窗口的句柄，uID为被显示图标的ID，uFlags指明其余的几个成员（hIcon、uCallBackMessage和szTip）的值是否有效，uCallbackMessage为一个自定义的消息，当用户在该图标上作用一些鼠标动作时，将向hWnd成员中指定的窗口发出该消息，可以定义该消息为WM_USER＋100。hIcon为被显示图标的句柄，szTip为一字符数组，当鼠标停留在该图标上时，将其内容显示在浮动的提示信息框中。Shell_NotifyIcon函数的另一个参数是一个预定义的消息，可以取如下值之一：NIM_ADD、NIM_DELETE或NIM_MODIFY，分别表示添加图标、删除图标或修改图标。<br>
    　　最后，要与用户进行交互，也就是当用户在该图标上单击或双击鼠标左键或右键时要执行相应的操作，至少也要响应用户终止该程序的意愿。上面已经提到，当用户在图标上进行鼠标动作时，将向hWnd成员中指定的窗口发出自定义的消息，该消息由uCallbackMessage成员指定（在上例中为WM_LIBEN，取值为WM_USER＋100）。因此，我们的任务就是在hWnd窗口中响应该自定义消息：<br>
    　　void CMainFrame::OnLiben(WPARAM wParam,LPARAM lParam)<br>
    　　{<br>
    　　UINT uID;//发出该消息的图标的ID<br>
    　　UINT uMouseMsg;//鼠标动作<br>
    　　POINT pt;<br>
    　　uID=(UINT) wParam;<br>
    　　uMouseMsg=(UINT) lParam;<br>
    　　if(uMouseMsg==WM_RBUTTONDOWN)//如果是单击右键<br>
    　　{<br>
    　　switch(uID)<br>
    　　{<br>
    　　case IDR_MAINFRAME://如果是我们的图标<br>
    　　GetCursorPos(＆pt);//取得鼠标位置<br>
    　　…//执行相应操作<br>
    　　break;<br>
    　　…<br>
    　　default:<br>
    　　…<br>
    　　}<br>
    　　}<br>
    　　return; <br>
    　　}<br>
    　　需要注意的是，首先要在该窗口类的头文件中给出该消息映射函数的原型说明： 
    <br>
    　　afx_msg void OnLiben(WPARAM wParam,LPARAM lParam);<br>
    　　并且要在CPP文件中的消息映射中加入相应的条目，注意一定要加在<br>
    　　//{{AFX_MSG_MAP(CMainFrame)和//}}AFX_MSG_MAP之外：<br>
    　　BEGIN_MESSAGE_MAP(CMainFrame, CFrameWnd)<br>
    　　//{{AFX_MSG_MAP(CMainFrame)<br>
    　　ON_WM_CREATE()<br>
    　　ON_COMMAND(ID_APP_EXIT, OnAppExit)<br>
    　　//}}AFX_MSG_MAP<br>
    　　ON_MESSAGE(WM_LIBEN,OnLiben)<br>
    　　END_MESSAGE_MAP()<br>
    　　当程序结束时，需要删去通告区中的图标，这时同样应该调用Shell_NotifyIcon函数，只不过第一个参数是表示删除图标的NIM_DELETE了：<br>
    　　void CMainFrame::OnAppExit() <br>
    　　{<br>
    　　// TODO: Add your command handler code here<br>
    　　NOTIFYICONDATA tnid;<br>
    　　tnid.cbSize=sizeof(NOTIFYICONDATA);<br>
    　　tnid.hWnd=this－&gt;m_hWnd;<br>
    　　tnid.uID=IDR_MAINFRAME;//保证删除的是我们的图标<br>
    　　Shell_NotifyIcon(NIM_DELETE,＆tnid);<br>
    　　AfxPostQuitMessage(0);<br>
    　　}<br>
    　　通过类似的步骤，读者可以响应其它的消息，完成了更加高级的交互功能，这里不再赘述。</p>
    <p>　</td>
  </tr>
  <tr>
    <td><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</table>
</div>

<p>　</p>
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" bordercolordark="#FFFFFF"
bordercolorlight="#000000">
  <tr>
    <td bgcolor="#FFC993" align="center"><a name="4"><strong>VB编程获取文件中集成的图标</strong></a></td>
  </tr>
  <tr>
    <td>　<p>---- 在Win95 下 的 应 用 软 件 使 用 了 打 量 精 美 的 图 标， 
    而 很 多 图 标 资 源 是 集 成 在EXE、DLL 文 件 中 的( 例 如Win95 的 回 
    收 站 就 使 用 了Shell32.dll 中 的 图 标,31 号 图 标 表 示 回 收 站 空,32 
    号 表 示 回 收 站 有 被 删 除 文 件) 在 我 们 编 程 中， 可 以 利 
    用Win95 的 API 函 数ExtractIcon 可 以 将EXE、DLL 文 件 中 的 图 标 资 源 
    取 出，下 面 通 过 一 个VB 的 例 子 通 过 使 用 该 函 数 将 文 件 
    中 包 含 的 图 标 取 出 并 且 在 一 个 图 片 框 内 浏 览。 <br>
    <br>
    ---- 1、 在Form1 的General 的Declarations 中 定 义 以 下 两 个 函 数: <br>
    <br>
    Private Declare Function ExtractIcon Lib <br>
    &quot;shell32.dll&quot; Alias &quot;ExtractIconA&quot; <br>
    (ByVal hInst As Long,ByVal lpszExeFileName <br>
    As String,ByVal nIconIndex As <br>
    Long) As Long <br>
    ExtractIcon函数包含三个参量: <br>
    hInst表示当前的程序实例 <br>
    lpszExeFileName表示包含图标的资源文件名 <br>
    nIconIndex表示要取出的图标的序号 <br>
    <br>
    ---- 如 果nIconIndex 为-1, 则 函 数 返 回 包 含 图 标 资 源 的 文 件 的 
    图 标 个 数. <br>
    <br>
    ---- 从 文 件 中 取 出 图 标 资 源 前, 应 首 先 调 用 该 函 数 获 得 
    文 件 中 包 含 的 图 标 资 源 的 个 数. <br>
    <br>
    ---- 如nIconIndex 为 图 标 资 源 的 序 号， 则 返 回 图 标 句 柄. <br>
    <br>
    Private Declare Function DrawIcon Lib <br>
    &quot;user32&quot; (ByVal hdc As Long,ByVal x <br>
    As Long, ByVal y As Long, ByVal hIcon As Long) As Long <br>
    DrawIcon函数将图标画到一个图形设备上， <br>
    hdc为图形设备句柄，x,y为起始位置， <br>
    hIcon为图标句柄。 <br>
    <br>
    ---- 定 义 三 个 全 局 变 量: <br>
    <br>
    Dim lNum As Long '图标的序号 <br>
    Dim lCount As Long '文件中包含的图标的总数 <br>
    Dim astr As String '包含图标的文件名 <br>
    <br>
    ---- 2、 在Form1 中 添 加 以 下 控 件: <br>
    <br>
    a、CommandButton,Name属性设置为COpen <br>
    b、CommandButton,Name属性设置为 <br>
    CPrv,Enabled属性设置为False <br>
    c、CommandButton,Name属性设置为 <br>
    CNext,Enabled属性设置为False <br>
    d、CommonDialog,Name属性设置为 <br>
    CommonDialog1,Filter属性设置为&quot;可执行文件(*.exe)| <br>
    *.exe|动态链接库(*.dll)|*.dll|所有文件(*.*)|*.*&quot; <br>
    <br>
    ---- 3、 全 部 源 程 序 如 下: <br>
    <br>
    Private Declare Function ExtractIcon <br>
    Lib &quot;shell32.dll&quot; Alias_ <br>
    &quot;ExtractIconA&quot; (ByVal hInst As Long, <br>
    ByVal lpszExeFileName As String,_ <br>
    ByVal nIconIndex As Long) As Long <br>
    Private Declare Function DrawIcon Lib <br>
    &quot;user32&quot; (ByVal hdc As Long, ByVal_ <br>
    x As Long, ByVal y As Long,ByVal <br>
    hIcon As Long) As Long <br>
    <br>
    Dim lNum As Long <br>
    Dim lCount As Long <br>
    Dim astr As String <br>
    <br>
    Private Sub CNext_Click() '浏览下一个图标 <br>
    lNum = lNum + 1 <br>
    x1 = ExtractIcon(App.hInstance, astr, lNum) <br>
    Form1.Refresh <br>
    x2 = DrawIcon(Form1.hdc, 10, 10, x1) <br>
    CPrv.Enabled = True <br>
    If lNum = lCount Then <br>
    CNext.Enabled = False <br>
    End If <br>
    End Sub <br>
    <br>
    Private Sub COpen_Click() '打开文件 <br>
    Dim x1 As Long <br>
    Dim x2 As Long <br>
    <br>
    CommonDialog1.ShowOpen <br>
    lCount = ExtractIcon(App.hInstance, <br>
    CommonDialog1.filename, -1) <br>
    If lCount &gt; 0 Then <br>
    astr = CommonDialog1.filename <br>
    lNum = 0 <br>
    Form1.Caption = astr <br>
    CPrv.Enabled = False: CNext.Enabled = True <br>
    x1 = ExtractIcon(App.hInstance, astr, lNum) <br>
    Form1.Refresh <br>
    x2 = DrawIcon(Form1.hdc, 10, 10, x1) <br>
    Else <br>
    x1 = MsgBox(&quot;File Contain no icon resource.&quot;) <br>
    CPrv.Enabled = False: CNext.Enabled = False <br>
    End If <br>
    End Sub <br>
    <br>
    Private Sub CPrv_Click() '浏览前一个图标 <br>
    lNum = lNum - 1 <br>
    x1 = ExtractIcon(App.hInstance, astr, lNum) <br>
    Form1.Refresh <br>
    x2 = DrawIcon(Form1.hdc, 10, 10, x1) <br>
    CNext.Enabled = True <br>
    If lNum = 0 Then <br>
    CPrv.Enabled = False <br>
    End If <br>
    End Sub</p>
    <p>　</td>
  </tr>
  <tr>
    <td><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</table>
</div>

<p>　</p>
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" bordercolordark="#FFFFFF"
bordercolorlight="#000000">
  <tr>
    <td bgcolor="#FFC993" align="center"><a name="5"><strong>监视剪贴板内容</strong></a></td>
  </tr>
  <tr>
    <td>　<p>---- 
    冲浪的年代，用过网络蚂蚁的人肯定不少，其中一项监视剪贴板变化的功能让人感觉到不少体贴。本文将介绍在Delphi中如何使用“体贴板”，来丰富自己的软件功能。 
    <br>
    <br>
    ---- Windows使用剪贴板观察器和观察链。剪贴板观察器是一个显示剪贴板当前内容的窗口。通常它应该至少能显示三种普通格式的内容：文字CF_TEXT、位图CF_BITMAP、元文件CF_METAFILEPICT。剪贴板观察链是一系列相互独立的剪贴板观察窗口，它们都能够接受当前发送到剪贴板的内容。我们大致按照以下步骤在窗口中处理有关剪贴板的内容。 
    <br>
    <br>
    ---- 首先，使用SetClipboardViewer（HWND）函数向剪贴板观察链中加入一个观察窗口。当剪贴板的内容发生变化时，该窗口会接收到一个WM_DRAWCLIPBOARD消息。该函数需要传递的参数是观察窗口的句柄。返回值也是一个窗口句柄类型，标识了将要加入的下一个窗口。 
    <br>
    <br>
    ---- 然后，响应WM_DRAWCLIPBOARD消息处理剪贴板内容的变化。 <br>
    <br>
    ---- 最后，在程序退出或关闭时需要调用ChangeClipboardChain函数来将自己从观察链中删除。然后调用SendMessage函数把这些消息传递到观察链中的下一个观察窗口。函数ChangeClipboardChain原型如下： 
    <br>
    <br>
    BOOL ChangeClipboardChain(<br>
    HWND hWndRemove,&nbsp;&nbsp;&nbsp; //将要删除的窗口的句柄<br>
    HWND hWndNewNext&nbsp;&nbsp;&nbsp;&nbsp; //观察链中下一个窗口的句柄<br>
    );&nbsp;&nbsp;&nbsp; <br>
    <br>
    ---- Delphi的clipbrd.pas单元中定义了一个类TClipboard，它封装了Windows剪贴板，简化了大量复杂的处理过程。我们在程序中可以直接调用全局函数Clipboard，该函数用于返回TClipboard对象实例，使用这个实例对剪贴板进行剪切、复制和粘贴等操作。下面是TClipboard对象的几个常用的方法和属性的简单介绍。 
    <br>
    <br>
    ---- 方法： <br>
    <br>
    ---- Assign：将指定的对象放入剪贴板中。 <br>
    <br>
    ---- Open：打开剪贴板，防止其他程序改写剪贴板。在向剪贴板加入多项数据时尤其有用。 
    <br>
    <br>
    ---- Close：关闭剪贴板。应该与打开剪贴板成对使用。 <br>
    <br>
    ---- Clear：清空剪贴板。 <br>
    <br>
    ---- GetAsHandle：返回剪贴板中指定格式数据的句柄。使用前必须打开剪贴板。 
    <br>
    <br>
    ---- GetComponent：返回剪贴板中的一个控件。Delphi自己使用得多。 <br>
    <br>
    ---- HasFormat：查询剪贴板中是否有指定格式的内容。 <br>
    <br>
    ---- 属性： <br>
    <br>
    ---- AsText：用于读写剪贴板文字内容。 <br>
    <br>
    ---- FormatCount：读剪贴板中数据格式的种数。 <br>
    <br>
    ---- Formats：返回剪贴板中各种格式的列表。 <br>
    <br>
    ---- 此外，Delphi中的许多控件中也封装了有关剪贴板处理的操作。下面的一个处理剪贴板的简单例子，只是将剪贴板的文字内容显示为窗口标题。 
    <br>
    <br>
    unit Unit1;<br>
    <br>
    interface<br>
    <br>
    uses<br>
    Windows, Messages, SysUtils, Classes,<br>
    Graphics, Controls, Forms, Dialogs,<br>
    Clipbrd;//加入clipbrd单元<br>
    <br>
    type<br>
    TForm1 = class(TForm)<br>
    procedure FormCreate(Sender: TObject);<br>
    procedure FormClose(Sender: TObject;<br>
    var Action: TCloseAction);<br>
    private<br>
    { Private declarations }<br>
    public<br>
    NextClipHwnd:HWND;//观察链中下一个窗口句柄<br>
    procedure WMDrawClipBoard<br>
    (var AMessage:TMessage);<br>
    message WM_DRAWCLIPBOARD;<br>
    //处理WM_DRAWCLIPBOARD消息过程<br>
    end;<br>
    <br>
    var<br>
    Form1: TForm1;<br>
    <br>
    implementation<br>
    <br>
    {$R *.DFM}<br>
    <br>
    { TForm1 }<br>
    <br>
    procedure TForm1.WMDrawClip<br>
    Board(var AMessage: TMessage);<br>
    begin<br>
    //将WM_DRAWCLIPBOARD<br>
    消息传递到下一个观察链中的窗口<br>
    SendMessage(NextClipHwnd,AMessage.<br>
    Msg,AMessage.WParam,AMessage.LParam);<br>
    //查询剪贴板中特定格式的数据内容<br>
    if (Clipboard.HasFormat(CF_TEXT) or<br>
    Clipboard.HasFormat(CF_OEMTEXT)) then<br>
    begin<br>
    //处理剪贴板中内容<br>
    Caption:=Clipboard.asText;<br>
    end;<br>
    end;<br>
    <br>
    procedure TForm1.FormCreate(Sender: TObject);<br>
    begin<br>
    //获得观察链中下一个窗口句柄<br>
    NextClipHwnd:=SetClipBoardViewer(Handle);<br>
    end;<br>
    <br>
    procedure TForm1.FormClose<br>
    (Sender: TObject; var Action: TCloseAction);<br>
    begin<br>
    //从观察链中删除本观察窗口<br>
    ChangeClipboardChain(Handle,NextClipHwnd);<br>
    //将WM_DRAWCLIPBOARD<br>
    消息传递到下一个观察链中的窗口<br>
    SendMessage(NextClipHwnd,WM_<br>
    CHANGECBCHAIN,Handle,NextClipHwnd);<br>
    end;<br>
    <br>
    end.<br>
    <br>
    ---- 需要注意的是，在处理剪贴板内容变化的消息WM_DRAWCLIPBOARD的过程和关闭窗口事件中使用函数sendmessage把WM_DRAWCLIPBOARD或WM_CHANGECBCHAIN消息传递到观察链中的下一个窗口是必要的，否则有可能其他窗口不能获得类似消息。另外，在使用网络蚂蚁时笔者曾经碰到不能设置剪贴板格式的情况，在此提醒读者注意检查RegisterClipboardFormat等函数的返回值。</p>
    <p>　</td>
  </tr>
  <tr>
    <td><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</table>
</div>

<p>　</p>
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" bordercolordark="#FFFFFF"
bordercolorlight="#000000">
  <tr>
    <td bgcolor="#FFC993" align="center"><strong><a name="6">巧用JavaScript记录网站访问次数<br>
    </a><br>
    浙江大学 梁俊清</strong></td>
  </tr>
  <tr>
    <td>　<p>我们知道Cookie是记录访问你站点的用户的信息，它驻留在用户的硬盘上，如果该用户再次返回你的站点，则该cookie就会被一起发回到你的服务器中，便于你统计和处理重复到访者的信息。在IE4和NS4两个浏览器中，都提供了对Coo 
    kie的支持，并且允许我们用JavaScript或者VBScript去操作它们。 <br>
    <br>
    为了简单了解一下Cookie读写的原理，请看以下例子。 <br>
    <br>
    <br>
    写Cookie：<br>
    &lt; script &gt;<br>
    function setCookie() <br>
    //建立设定Cookie的函数 <br>
    { var the_visits = 1; <br>
    //初始化VISIT，即访问次数为1<br>
    var the_cookie = &quot;3Ware=uservisits:&quot;<br>
    + escape(the_visits);<br>
    <br>
    //加入自己的标识符，并用escape函数对Cookie编码<br>
    document.cookie = the_cookie;//写入Cookie<br>
    } <br>
    &lt; /script &gt; <br>
    <br>
    ---- 这样，将生成一个字符串3Ware=uservisits:1，就是把一个名为3Ware的Cookie 
    保存到硬盘里，该Cookie的值就是uservisits:1。当我们读Cookie的时候，只需 
    寻找名字为3Ware的Cookie，然后用unescape解码，读出访问次数。 <br>
    读Cookie：<br>
    &lt; script &gt;<br>
    function readCookie()<br>
    { var the_cookie = document.cookie; <br>
    //获得已写的Cookie值<br>
    var broken_cookie = the_cookie.split(&quot;:&quot;);<br>
    //找出分隔符<br>
    var the_visits = broken_cookie[1]; <br>
    //读出分隔符后一部分<br>
    var the_visits = unescape(the_visits);<br>
    //用unescape函数对Cookie解码<br>
    document.writeln(&quot;Your visits is: &quot;<br>
    + the_visits); //写出访问次数<br>
    }<br>
    &lt; /script &gt;<br>
    <br>
    这样，将生成一个字符串3Ware=uservisits:1，就是把一个名为3Ware的Cookie 
    保存到硬盘里，该Cookie的值就是uservisits:1。当我们读Cookie的时候，只需寻找名字为3Ware的Cookie，然后用unescape解码，读出访问次数。 
    <br>
    <br>
    <br>
    读Cookie：<br>
    &lt; script &gt;<br>
    function readCookie()<br>
    { var the_cookie = document.cookie; <br>
    //获得已写的Cookie值<br>
    var broken_cookie = the_cookie.split(&quot;:&quot;);<br>
    //找出分隔符<br>
    var the_visits = broken_cookie[1]; <br>
    //读出分隔符后一部分<br>
    var the_visits = unescape(the_visits);<br>
    //用unescape函数对Cookie解码<br>
    document.writeln(&quot;Your visits is: &quot;<br>
    + the_visits); //写出访问次数<br>
    }<br>
    &lt; /script &gt;<br>
    <br>
    最后在网页中加入“&lt; script &gt;setCookie();readCookie();&lt; /script &gt;”就 
    能记住访问的次数了。<br>
    <br>
    但，这个只是基本的原理，实际操作还涉及到Cookie存放的路径，什么时候失效，它的有效作用域在那里，以及检查访问次数是否存在等问题。考虑到以上问题，实际的程序如下： 
    <br>
    <br>
    <br>
    &lt; html &gt;<br>
    return unescape(document.cookie.<br>
    substring(offset, endstr));<br>
    }<br>
    function Gookie(name) <br>
    //获得Cookie的原始值<br>
    { var arg = name + &quot;=&quot;;<br>
    var alen = arg.length;<br>
    var clen = document.cookie.length;<br>
    var i = 0;<br>
    while (i &lt; clen)<br>
    {<br>
    var j = i + alen;<br>
    if (document.cookie.<br>
    substring(i, j) == arg)<br>
    return GookieVal (j);<br>
    i = document.cookie.indexOf(&quot; &quot;, i) + 1;<br>
    if (i == 0) break;<br>
    }<br>
    return null;<br>
    }<br>
    function Sookie(name, value) <br>
    //设定Cookie值<br>
    { var argv = Sookie.arguments;<br>
    var argc = Sookie.arguments.length;<br>
    var expires = (argc &gt; 2) ? argv[2] : null;<br>
    var path = (argc &gt; 3) ? argv[3] : null;<br>
    var domain = (argc &gt; 4) ? argv[4] : null;<br>
    var secure = (argc &gt; 5) ? argv[5] : false;<br>
    document.cookie = name + &quot;=&quot; + <br>
    escape (value) +((expires == null) ?<br>
    &quot;&quot; : (&quot;; expires=&quot;+ expires.toGMTString()))<br>
    +((path == null) ? &quot;&quot; : <br>
    (&quot;; path=&quot; + path)) +((domain == null) ? &quot;&quot;<br>
    : (&quot;; domain=&quot; + domain))<br>
    +((secure == true) ? &quot;; secure&quot; : &quot;&quot;);<br>
    }<br>
    function Dookie(name)<br>
    { var exp = new Date();<br>
    exp.setTime (exp.getTime() - 1);<br>
    var cval = Gookie (name);<br>
    document.cookie = name + &quot;=&quot; + cval + &quot;; <br>
    expires=&quot;+ exp.toGMTString();<br>
    }<br>
    &lt; /script &gt;<br>
    &lt; script &gt;<br>
    var expdate = new Date();<br>
    expdate.setTime(expdate.getTime() + <br>
    (24 * 60 * 60 * 1000 * 365));<br>
    if(!(visits = Gookie(&quot;3wave&quot;))) <br>
    { visits = 1;<br>
    Sookie(&quot;3wave&quot;, visits, expdate, &quot;/&quot;, null, false);<br>
    document.write(&quot;这是您第&quot; + visits + &quot;次光临本站&quot;);}<br>
    else{ visits++; <br>
    Sookie(&quot;3wave&quot;, visits, expdate, &quot;/&quot;, null, false);<br>
    document.write(&quot;您已经第&quot; + visits + &quot;次光临小站&quot;);<br>
    } <br>
    if(visits&lt; 2)<br>
    document.write(&quot;,是小站的新手上路，加油哦。&quot;)<br>
    if(visits &gt;=2&amp;&amp;visits&lt; 4)<br>
    document.write(&quot;,是小站的初级站友，不错嘛。&quot;) <br>
    if(visits &gt;=4&amp;&amp;visits&lt; 6)<br>
    document.write(&quot;,是小站的高级站友，很厉害啊！&quot;) <br>
    if(visits &gt;=6)<br>
    document.write(&quot;,是小站的支柱，我实在太感动了！&quot;) <br>
    &lt; /script &gt;<br>
    &lt; /html &gt;<br>
    <br>
    在判断访问次数所表达的句子上，你可以根据网站的风格，改为有自己个性的话语，相信，如果访问者在你的网站上看到这些话，留给他的印象一定很深刻，这样就可以让你的网站更加吸引别人了。</p>
    <p>　</td>
  </tr>
  <tr>
    <td><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</table>
</div>

<p>　</p>

<h1><a name="xzzq"><span style="background-color: rgb(0,255,255)"><font color="#FF0000">下 
载 专 区</font></span></a></h1>
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" bordercolordark="#FFFFFF"
bordercolorlight="#000000" height="104">
  <tr>
    <td bgcolor="#FFC993" height="40"><font color="#800080">我主页更新加入大量的编程工具，以下只是其中的5个。如果想要更多的编程工具、程序源码和控件的话，请来我的主页看看吧。</font><a
    href="http://www.pfan.net">http://www.pfan.net</a></td>
  </tr>
  <tr>
    <td height="43">　<p><font color="#800080"><strong>WinHEX 9.38&nbsp; （430KB 
    &nbsp; 共享软件）</strong></font><br>
    相关站点<br>
    <a href="http://www.winhex.com/">http://www.winhex.com/</a><br>
    下载链接<br>
    <a href="http://www.winhex.com/winhex.zip">http://www.winhex.com/winhex.zip</a><br>
    <a href="http://www.sf-soft.de/winhex.zip">http://www.sf-soft.de/winhex.zip</a><br>
    老牌Hex 十六进制编辑器工具，文件小、速度快，可做 Hex 与 ASCII 
    码编辑修改，多文件搜寻取代功能，一般运算及逻辑运算，硬盘磁区编辑(支持FAT16、FAT32和NTFS)自动搜寻编辑，文件对比和分析等功能，新增了RAM编辑功能。Code1:789789 
    &nbsp;&nbsp; Code2:294872</p>
    <p>　</p>
    <p><strong><font color="#800080">Help &amp; Manual 2.52&nbsp; （47MB 
    &nbsp; 共享软件）</font></strong><br>
    相关站点<br>
    <a href="http://www.ec-software.com/hmpage.htm">http://www.ec-software.com/hmpage.htm</a><br>
    下载链接<br>
    <a href="http://www.ec-software.com/pgm/hman2x.zip">http://www.ec-software.com/pgm/hman2x.zip</a><br>
    Help &amp; Manual是一个所见即所得的 HELP 文件制作工具。<br>
    Help &amp; Manual可以很容易的创建Windows 3.x及Windows 95下的帮助文件并支持HTML帮助文件格式。Help 
    &amp; Manual能让你容易的创建和管理帮助文件内容包括标题、图像、宏、OLE对象和链接。利用的同样的数据，您还可以创建普通的HTML页面和RTF文件。</p>
    <p>　</p>
    <p><strong><font color="#800080">Quick Install Maker 2000 V2.22&nbsp; （1732KB 
    &nbsp; 共享软件）</font></strong><br>
    下载链接<br>
    <a href="http://www.mjksw.com/shareware/qim2000s.exe">http://www.mjksw.com/shareware/qim2000s.exe</a><br>
    <a href="http://newhua.xingtai.net/down/qim2000s.exe">http://newhua.xingtai.net/down/qim2000s.exe</a><br>
    <a href="http://www.mjksw.com/shareware/qim2000s.exe"></a>软件安装程序制作工具，可制作多盘的 
    ZIP 或 EXE 压缩文件</p>
    <p>　</p>
    <p><strong><font color="#800080">Xtreeme InstallXpert V2.0&nbsp; （1171KB 
    &nbsp; 共享软件）</font></strong><br>
    相关站点<br>
    <a href="http://www.xtreeme.com/installxpert/index.html">http://www.xtreeme.com/installxpert/index.html</a><br>
    下载链接<br>
    <a href="http://www.xtreeme.com/installxpert/IXInstall.exe">http://www.xtreeme.com/installxpert/IXInstall.exe</a><br>
    是一个可以制作自解安装程序的工具。只要照着介面上的步骤依序输入文件所在资料夹、执行文件名、储存文件名和资料夹、安装标题、安装信息文字等，按下「Generate」即可立刻将文件打包成单一自解安装程序(EXE)，只要直接执行便会将文件解压至暂时资料夹安装，且安装好后会自动将暂时资料夹内的文件删除。</p>
    <p>　</p>
    <p><font color="#800080"><strong>Applet Button Factory 5.1&nbsp; （1997KB）</strong></font><br>
    下载链接<br>
    <a href="ftp://member.myrice.com/czy/dl4/Tbc-ABF51.zip">ftp://member.myrice.com/czy/dl4/Tbc-ABF51.zip<br>
    </a>建立主页动画按钮的 JAVA applet wizard。能轻易的做出Java的按钮，新版的多了150个音效和300个按钮图形文件。<a
    href="ftp://member.myrice.com/czy/dl4/TNT-ABF50-CRK.ZIP">注册器</a></p>
    <p>　</td>
  </tr>
  <tr>
    <td height="15"><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</table>
</div>

<p>　</p>

<h1><a name="ywbd"><span style="background-color: rgb(0,255,255)"><font color="#FF0000">有 
问 必 答</font></span></a></h1>
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" bordercolordark="#FFFFFF"
bordercolorlight="#000000" height="116">
  <tr>
    <td bgcolor="#FFC993" height="52"><font color="#800080">提问信箱: </font><a
    href="mailto:yaoz@citiz.net?subject=question">yaoz@citiz.net?subject=question</a><font
    color="#800080"><br>
    如果您有什么疑难问题，请发到上面的信箱里，我会及时把您的问题放在杂志上的，希望编程高手们能不吝赐教，也希望这个栏目能成为大家交流的场所。</font></td>
  </tr>
  <tr>
    <td height="43">　<p>201. 回答请mailto: <a href="mailto:yaoz@citiz.net?subject=201">yaoz@citiz.net?subject=201</a><br>
    我现在正在学习用VC 5.0编程，但是遇到一问题，望各位大虾帮忙解决！我在<br>
    学校用的是VC 6.0编程，我用应用程序向导做一个供用户注册用的窗体式程序，在学校<br>
    能正确通过，但是在家中的5.0版本中运行到Mainfrm.cpp的文件中的CreateEx函数（这<br>
    是由向导自动生成的）<br>
    if (!m_wndToolBar.CreateEx( this,TBSTYLE_FLAT, WS_CHILD | WS_VISIBLE |<br>
    CBRS_TOP<br>
    /*| CBRS_GRIPPER */| CBRS_TOOLTIPS | CBRS_FLYBY | CBRS_SIZE_DYNAMIC) ||<br>
    !m_wndToolBar.LoadToolBar(IDR_MAINFRAME))中却报错：error C2661: 'CreateEx'<br>
    : no overloaded function takes 3 parameters<br>
    Error executing cl.exe.<br>
    请问各位大虾：在5.0版本中这个函数的正确写法。我先在这里谢过各位大虾。阿,忘了,我的邮箱是： 
    <a href="mailto:ervin_lj@kali.com.cn">ervin_lj@kali.com.cn</a></p>
    <p>202. 回答请mailto: <a href="mailto:yaoz@citiz.net?subject=202">yaoz@citiz.net?subject=202</a><br>
    请教各位高手,如何在win98下读写CMOS数据(不是BIOS数据,最好使用Delphi编程)!<br>
    <a href="mailto:qs75@163.net">qs75@163.net</a></p>
    <p>203. 回答请mailto: <a href="mailto:yaoz@citiz.net?subject=203">yaoz@citiz.net?subject=203</a><br>
    请问如何用Delphi实现对IE地址的Import&amp;Emport,最好提供code of the 
    Function,谢谢!<br>
    <a href="mailto:liuyan55@citiz.net">liuyan55@citiz.net</a></p>
    <p>204. 回答请mailto: <a href="mailto:yaoz@citiz.net?subject=204">yaoz@citiz.net?subject=204</a><br>
    matlab中的fmins 函数如何使用？举个例子！急！ <a
    href="mailto:tianj1234@263.net">tianj1234@263.net</a></p>
    <p>　</td>
  </tr>
  <tr>
    <td height="15"><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</table>
</div>

<p>　</p>

<h1><a name="zzxx"><span style="background-color: rgb(0,255,255)"><font color="#FF0000">杂 
志 信 息</font></span></a></h1>
<div align="left">

<table border="1" cellpadding="0" cellspacing="0" width="500" bordercolordark="#FFFFFF"
bordercolorlight="#000000">
  <tr>
    <td bgcolor="#FFC993"><a name="subscribe"><strong>《编程爱好者》订退方法</strong></a><p><strong>退订</strong>：请以UNSUBSCRIBE 
    pfan为标题回信到 <a href="mailto:unsubscribe@buzzcity.com">unsubscribe@buzzcity.com</a><br>
    <strong>订阅</strong>：请在下面的文本框内输入您订阅本刊的邮件地址，并按右面的订阅按钮即可。如果您觉得这份刊物还不错的话，欢迎把它推荐给您的朋友。</p>
    <form name="buzzform" action="http://my.czine.buzzcity.com/cgi-bin/addBuzz">
      <input type="hidden" name="bidhost" value="broker.czine.buzzcity.com"><input type="hidden"
      name="gid" value="pfan"><input type="hidden" name="PF" value="czine"><p><input
      type="checkbox" name="bid"
      value="bdf34278f45a6678f875a9596af27c88,编程爱好者:编程技术,Su|" checked><a
      href="http://czine.buzzcity.com/Top/pfan/pfan_programm/"><b>订阅《编程爱好者》</b></a><input
      name="userid" size="15" maxlength="32"><input type="submit" value="赶快订阅!"
      style="font-family: 宋体; font-size: 9pt; background-color: rgb(0,255,255)"></p>
    </form>
    </td>
  </tr>
  <tr>
    <td>　<p>本刊已加入【CHINA-EZL】中国电子杂志联盟<br>
    联盟主页地址 <a href="http://china-ezl.yeah.net">http://china-ezl.yeah.net</a><br>
    <br>
    ◆欢迎光临我的个人主页<br>
    <br>
    ●《编程爱好者》<br>
    <a href="http://www.pfan.net">http://www.pfan.net</a> &nbsp; 
    （国际顶级域名主力站点）<br>
    <a href="http://person.zj.cninfo.net/~yao">http://person.zj.cninfo.net/~yao</a>&nbsp; （169镜像站点）<br>
    本刊的同名主页，主要以收集各类编程工具控件和程序源代码为主。</p>
    <p>不知道您看了这期刊物有什么想法或者是意见，欢迎向我提出来。<br>
    本人感激不尽，我的联系方法如下:<br>
    E-mail： <a href="mailto:yaoz@citiz.net">yaoz@citiz.net</a><br>
    ICQ#： 43260473</td>
  </tr>
  <tr>
    <td><p align="right"><a href="50.htm#top">Top</a></td>
  </tr>
</table>
</div>

<p><img
src="http://www.pfan.net/cgi-sys/Count.sys?st=55000&amp;md=6&amp;dd=cd&amp;tr=T&amp;ft=0&amp;frgb=Black&amp;df=pfan.net241.dat"
align="absmiddle" width="1" height="1"><img
src="http://person.zj.cninfo.net/cgi-bin/Count.cgi?ft=6&amp;frgb=0;215;255&amp;dd=C&amp;df=yao.dat"
width="1" height="1"></p>
</body>
</html>
